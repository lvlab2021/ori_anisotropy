
clear all;
Lcolor = [245 144 168]/255; Rcolor=[0 187 201]/255;
modelacolor = [0.8 0.1 0.1]; modelbcolor=[0.1 0.1 0.8];modelccolor=[0.8 0.1 0.8];model0color=[0.55 0.55 0.55];Bcolor = [0.1 0.1 0.1];

%% data reading
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  modify here then statistics
for inNN = [1:6]   %%% ×¢Òâ»áoutput ivf
% for inNN = ???  
    
    %%%%%%%%%%%%%%%%%%%%%%% maybe need to modify %%%%%%%%%%%%%%%%%%
    % inN = 4;  %%%% 1 for LV1; 2 RV1;  3 for LV4; 4 RV4;    %%%%% for all  
    inN = inNN;  %%% for cycle
    %%%%%%%%%%%%%%
    nameindex = [{'LV1'},{'RV1'},{'LV4'},{'RV4'},{'LV2'},{'RV2'}];
    tempname = nameindex{inN};
    Resultfolder = [pwd,'\Fitting_Results\'];
    
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% load fitted data
    for fittingload =1

        V1LRaOri = [121.796330371969,109.606450089087,110.468132911126,119.030351239838,118.592602682600,122.918917215971,128.118456265052,115.226370716462,134.944174973321,130.284628099546,113.079516042469,126.863490894721,119.449754993943,118.751455540980,122.125190280634,129.401780694249,119.218714899910,123.989967002067,115.474858778181,125.675621428065,146.203716731979,128.792592818963,106.558115247290,124.217256634565,109.557243378465,121.804730864251-5];
        V1RRaOri = [60.7805039738264,62.1657108204518,70.0798614481037,51.5440360831934,51.3943079867949,67.3283439614036,64.8629286212368,67.8247353208828,51.0332097778726,54.6029049132986,61.1114030323451,52.3247586676223,49.3097981267163,57.0136947557376,51.5031340422491,55.6686041829385,49.9237092027872,60.4289895433539,75.2551550445333,66.9176123945516,69.4370480444419,67.5729552640325];
        V4LRaOri = [133.396571438581,139.923982584023,133.251068853996,130.168662809262,127.206351861087,139.244709025595,133.938749694490,132.006576831034,132.099753919118,129.890102655013,137.617373265116,135.110323395035,129.890102655013,130.547218157796,135.852631840676,138.738999145747,136.360307900705,127.254820711932,135.179486867115,142.891287492460,128.542924728708,136.635785701017,136.851412388174];
        V4RRaOri = [43.9094649951697,46.5419388338852,48.9226497426267,47.3698394161760,45.1922118348316,40.7407583578652,45.0109089625959,45.9733877223262,43.5685517709776,45.7300705311051,50.6963086233522,41.7644694828548,41.0718107843144,40.1657385874589,47.8888037784861];
        V2LRaOri = [103.367635583938,112.482960466317,98.2526945557180,102.154746658705,107.741906333383,111.829831353379,111.554574346769,99.8998776697561,103.776162968949,103.853704471438,106.910019562728,104.656616182388,99.4993525307770,111.554574346769,99.2878358570155,101.415643747782,102.458081081578,103.819768284771,105.254546650177,105.157110181935,103.234973703154,106.890713185945,106.642966425756,102.609299187035,106.231715148973,100.606813618627,99.3787745209166]  ;
        V2RRaOri = [66.8297305697660,73.8003071503311,77.0903908584480,66.9757611912338,84.2340513607137,78.2863936209441,71.5125827032115,74.5803630860158,79.6634106159910,69.1200569404351,75.6144986690253,65.0767089393466,74.7080993576759,81.5513748924920,63.4209461143712,60.3963935595179,67.0646441330466,58.4390501201986,77.3393653206987,76.9934735244740,78.2222264846092,81.0579155159376,73.3027611869614,75.6675066928794];
            
        V1LOrdCurve = [6.21970124644928,5.03980514279176,4.90337345312765,5.99224058666547,5.22348464057669,5.85235873075662,5.98236036511990,6.27405808935029,5.36689202568527,5.74268425282466,4.98546582438818,5.21521555367709,6.45548116318577,5.60857065263197,5.43355301987016,7.75078377153638,4.96376120541675,5.18629827649188,5.73985381715101,5.66180095168154,6.23223740208030,5.61139617159860,5.34144973303139,5.35547916599737,5.36847242557345,5.56519259558492;6.23045422367985,4.33197652559136,4.66816409560943,6.01130272925030,5.40095504692903,5.10947886803245,5.67564791171377,5.96203196080719,4.90721620321915,5.64104382357113,5.25341431332110,4.95621301775148,5.92751740448353,5.22742384087355,5.49380287231950,8.14659995745901,5.15353805073431,5.26267724902866,5.62405624982630,5.33585505467642,5.62921072752716,5.62311098615309,4.77219371325286,5.10489285829023,5.19359036928583,5.49628115866264;5.82452933322580,4.25024111944812,4.96270554331243,5.36655378888116,5.42199535283678,4.64910261507662,5.35866279240410,5.46483144756795,4.90650900964612,5.29830284120456,5.08777342925348,4.74860524091293,5.06312248093002,5.21618609703792,5.59216997835924,6.85002450731058,5.30898340644669,5.12901404708930,5.42766357564360,5.16584006518918,5.29884443931503,5.45207469365760,4.64546153366713,5.23982394705561,4.46965999674638,5.27766556566785;5.41770836133588,4.24697170320239,5.49033734531277,5.02231391984930,5.52262290283038,4.88277844044057,5.18696251944469,5.22425055406509,5.17807134168765,4.86810381506169,5.17059387128729,5.12662721893491,4.56180673528530,5.12534766769992,5.27493606138107,5.15300885037593,5.57314514590883,5.35316972736028,5.11084143144321,5.07529953824331,5.51956951397204,5.66059839272744,5.34352730974591,4.74186397661195,4.45745892305190,4.99489104864197;5.65158561610079,4.87633433050529,6.26377352093575,4.77786997376152,5.51256014783102,5.22387539149420,5.24859851486602,5.27819899685058,5.02956069135244,5.13402354275989,5.77794377953523,5.47624683009298,4.77998734219380,5.05042937546239,5.14828841235491,4.30496342399497,5.84016784283807,5.69604489755255,5.16735064429767,5.56522438960595,5.63065337507394,5.69808579930180,5.14615752186649,5.02136408905452,4.63640800390434,5.08043628068341;5.36483955661891,5.49915812531672,6.90583149686387,4.79693211634635,5.30581627238963,5.37803168225668,5.43937659593203,5.33506357167853,4.87256371814093,4.85983075686664,6.08973838483899,5.24158918005072,4.66340228506712,5.25177228585074,5.05238048396616,3.92116969231765,5.47396528704940,5.83053830571514,5.06359602397473,5.68493908634548,5.31615620987637,5.35367025139992,5.19809693972950,4.66476049731744,5.26272978688791,5.05904997267305;5.13544270903340,5.25231719876416,6.18537040176301,4.95952097956987,5.19055198785151,5.22666555060302,5.59933667928737,5.31027644931763,5.31243812056236,5.02056445894199,5.55871319768103,5.19966187658495,4.95153392625162,5.46809885468661,5.32166043674995,4.00810128455300,5.36143429334351,5.63460963703384,5.28963287539255,5.00286711668662,5.26999148837947,5.23652210585506,5.39131157417988,4.21820284640344,5.23832763949894,4.96875222774042;5.32182764769662,5.57271999084563,5.60264451601966,5.30151824359176,5.39912545511097,5.65007219536694,5.67344662616301,5.57856059722384,5.86687788181381,5.14938779369357,5.88999496581627,5.39983093829248,5.62106525432198,5.70596443254076,5.74095022624434,4.69153156819044,5.15258439824528,5.57815561385448,5.26554698138902,5.07328752653340,5.25700766045847,5.31149691900377,5.30820850559907,4.75150191152376,5.25459573775826,5.18499156428962;5.70624658368953,6.45709708531542,5.26360400067808,5.76013096813258,5.96629891871124,6.39225451831391,5.53109682721376,5.73603172751662,6.50052332324404,5.21084479742826,6.02640510563666,5.91039729501268,6.01245794610439,6.14610939943624,6.00777100137714,5.62280937011588,5.41960709517452,5.82638727459901,5.83434463208797,5.27046467410440,5.72154017052094,5.25526580914224,6.00835185839237,5.42615735535066,5.68976736619489,5.10182258869377;6.00822602758139,6.86740882415445,5.35472113917613,6.20304545760355,6.33313207823335,6.52478707598301,5.58246015673153,6.20115478828881,6.37747164153772,5.51694795064530,5.77307198882736,5.96923076923077,6.30392058892109,6.33715104464194,5.97580169191422,6.63639474341308,5.70474918939538,5.95423903297579,6.32254717592893,5.50486403830870,5.98410202403451,5.32086877064736,6.85184800448757,6.04941047964789,5.68163331706524,5.52479623600979;5.41591619846412,5.63320419139163,5.13434480420410,6.38133255589693,5.78882851235889,5.96117493600073,5.60080420298788,6.04514172401726,5.85980594608356,5.71904694369593,5.23067929001770,6.17886728655959,5.95249991672496,6.31561203562365,6.08400550855794,6.56518482211392,5.88498950982262,5.48932354796932,6.18914837837087,5.28555476192871,5.66094897355627,5.49190506314285,7.00766625807658,7.01641661579979,5.64503009598178,6.10222655228952;5.20175273528858,5.27193369623854,5.22546194270215,6.37236213585701,5.69643412554659,5.46034137596696,5.45845440403863,5.78998017030211,5.49772283669486,6.13388171890512,5.15922635963559,6.17683854606932,5.36457812864328,5.73780470674171,5.67332284084202,5.55344905716215,5.79439252336449,5.25105436190350,6.30216680407978,5.28857277949358,5.25412236536492,5.32086877064736,6.58176303159994,7.29591672824236,5.97039206116805,6.49668512225840;5.39441024400298,5.51387049842251,5.29327004577047,5.96981453656568,5.66899024827561,5.59287393363607,5.44451292888380,5.23883121427738,5.51823145031258,6.06887911880112,5.55059354650124,6.04564666103128,5.57110022983911,5.99065394304337,5.54544560299036,5.21404592577522,6.20732405111577,5.55075880848803,5.71484154260887,5.99378288381638,5.21517088160192,5.97689838569855,5.79020630336775,6.60519805956244,6.36082641939157,6.22103937456930;5.91951396542918,6.44728883657823,6.07730123749788,5.89805117624633,5.97727646961963,6.08045423790292,5.86936104018080,5.10614720634550,5.99912307996945,6.10315321703777,6.76854122346904,6.38512256973795,5.52613170780454,5.70877386849967,5.43847137517214,4.67858430977241,6.46194926568758,6.23069770531000,5.58978016989819,6.94144039918312,5.40992830041693,6.03547245847098,5.60322439906094,5.95945642047097,6.62518301610542,6.15212793764703;5.62111884728084,6.85596586729440,6.44600779793185,5.29927563858178,6.18036116142489,6.12718940297571,5.86936104018080,5.20237956374665,6.32301773641481,6.18706566444476,6.48760129264847,6.11462383770076,5.54944871922987,5.45405167489207,5.84177650993508,4.60552478012781,6.11386610719054,6.21658419951516,5.20162672422578,6.66378278321580,5.44887978417993,6.08467467959982,5.56167286477053,5.94981848555916,6.24288270701155,5.96915619133617;4.95174601467781,6.40642113350661,5.81030683166638,5.26003005090713,5.50524178055876,5.43453240421035,5.49954506765284,5.07261168785723,5.63845435772680,6.04642367512882,5.28426898780428,5.67371090448014,5.50114919556311,5.04106458893270,5.72988392681487,4.67765950559969,5.56837688346367,5.60638262544416,5.18865739668541,5.69499914489502,5.52534010415915,5.77540357536140,5.11499387114869,5.77954830211713,6.25508378070604,5.64836157118076;5.08078174144466,5.97649289719321,5.47974232920834,5.16135543046803,5.01948515286240,5.02228639588173,5.36233160165537,5.11343753645165,5.27142089332692,5.55594951070770,4.90589324282629,5.07726120033812,6.01911994936878,5.17966342957212,5.25403305134763,5.30467673470143,5.06198741178715,5.02357785673961,5.34799484932421,5.28354275021881,5.57006217810927,5.38647173215248,5.32067396588619,5.64461721335175,5.79551000488043,5.50578618444503;5.53419894800039,5.50079283343959,4.93303949822004,5.46634971182526,4.88683974605266,5.43174224510153,5.61768072554372,6.06701271433571,5.57409974258154,5.74386611828110,5.00008119651180,5.10431107354184,6.17567702608174,5.43532210183269,5.39174699980327,6.31548769548048,4.95517833301545,5.18048683292930,5.62035072767191,5.50788205587357,6.05623440137340,5.40521543543966,5.01319261213720,5.17557104764353,5.85244834878803,5.65073782762636];
        V1ROrdCurve = [5.77072310405644,5.09539874294833,5.13851961040929,5.22416702712911,6.22980483391495,5.77170473905636,6.15560442104045,5.73521068647171,5.46327397659473,5.57380357162876,6.78881592882864,6.03404068276721,5.38179499442053,5.64572062699404,5.89018246760905,5.21866960676222,5.27027027027027,5.30508154398338,5.58500876799478,5.69559263579652,5.23149167216964,5.49521872701311;5.72310405643739,4.83222979688397,5.30245629503093,4.96889869075977,5.72444099780277,5.69173533604534,5.87639604189572,5.31486925576358,5.27692142517523,5.48187841216103,6.02361787756831,5.72635588874509,4.93065518890483,5.50700513247330,5.55827001162536,4.53877251010658,5.30487804878049,5.26415213147787,5.38925818686024,5.11741137089821,5.10308900139409,5.22262126260223;5.40035273368607,4.89522236376108,5.01453388254419,5.02190190141403,5.41682822799535,5.30463706639778,5.01273074474857,5.16401052142968,4.98397214681207,5.27000212997321,5.16045329379369,5.69949451783839,4.99920293320580,5.59419772902919,5.05618924064495,4.81096104373392,5.05273566249176,5.08154398337636,4.93862403654011,4.83339250393062,4.78758529605987,5.60339232400156;5.32980599647266,5.53494687626860,5.14127484880629,5.42825984976331,5.52281245960967,5.49123234009017,5.15739829870957,5.96085409252669,5.38888633261246,5.46057868008924,5.10352679517052,5.66042343288320,5.56671449067432,5.54267483106434,5.03260155341769,5.14401874310915,5.27356624917601,4.99496253384548,5.03853839566086,4.76745955267029,5.52865213882163,6.30435723248669;5.47089947089947,6.35944958494898,5.63446252186971,6.01677825771745,5.95256559389944,5.49123234009017,5.49302702389908,5.62819124245706,5.93337321124557,5.91347824624732,5.40272188095742,5.99008571219262,6.07364897178384,5.69724352495888,5.23309689484946,5.57354832782066,5.73994726433751,5.71752408538505,5.91941601076628,5.57387026423898,6.15232225401717,5.97118255376228;5.74250440917108,5.90310343379481,5.72814062736778,6.44872396293431,6.26987204342769,5.63958137755989,5.73028181239512,5.37676001856723,5.98015306983236,5.74195935114290,5.74825248887948,5.91194354228224,5.91264147935597,5.73489487347165,5.13706131113844,5.93646637265711,5.80421885299934,5.87022227819407,6.33538599567717,6.40563980321550,7.12451390417492,6.57262775301804;6.20987654320988,5.63993448773045,5.53802917797462,6.23792958493003,6.00297272844772,5.95714103589351,5.50894045483479,5.39996905461860,5.45867267902882,5.41685817741556,5.34314763821224,5.97543405533442,5.77873425793081,5.85181221885342,5.11515845871312,6.27411797133407,6.02340145023072,6.06070146716202,6.15390889441703,6.88238575848253,6.86770856262382,6.78464800311540;6.39682539682540,5.65113316628638,5.54629489316563,6.20442180807964,5.84916634354401,6.25152115712249,5.89664949945026,5.20398163907370,5.33367076182150,5.46057868008924,5.64631434018216,5.87287245732705,5.78989319304958,5.67544537581991,5.41674388826176,6.69790518191841,6.21127224785761,6.03393992821611,5.98670527303128,6.41578333417863,6.30273681121139,6.21781835489594;5.43209876543210,6.00809104525666,6.11249638374960,6.57117965651483,5.80134419025462,6.47288573647184,6.07603726636190,5.04925473206457,5.68643690854154,6.23073215026400,6.34664266045330,5.78984640179727,5.85206440299697,5.43170243544775,6.25242195002780,7.22046122748989,6.30026367831246,6.32044581575468,6.55560539945353,6.21798448039763,5.53965808203096,5.80243174246030;5.36684303350970,6.16487254503969,6.85503313174172,6.76065090379613,5.97712291585886,6.52735764866776,6.44204617788323,5.16272113053793,6.36129388487554,6.78788829972086,6.54522346960390,5.68484286098020,5.76119878845847,5.65761052652438,6.51020167472579,7.30085446527012,6.07943309162821,6.19923178641144,6.55764446800702,6.30927625906578,5.83314990094651,5.56877677296525;5.11816578483245,5.76731945630416,6.45414594497789,6.12461237594507,5.73607341346775,6.27701864793760,5.53498061454777,5.36257671875806,5.92186996733079,6.18028541640976,5.88990679940691,5.28192229737980,5.75641638769329,5.53474823137745,6.42764476943036,6.01226571113561,5.88497033618985,6.11737296140042,5.95611924472901,5.63473145001775,5.83681854868296,5.48223789537450;5.07054673721340,5.18358833657628,5.70747633939027,5.20832698716348,5.16026883805092,5.23509845508385,4.97077715409988,5.82159987621848,5.39195386432307,5.38322702151273,5.00423639059521,5.05970550169715,5.39614219671608,5.57239957989022,5.96263036409280,4.97404446894524,5.46143704680290,5.48768969208488,5.03446025855389,5.29999492823452,4.84261501210654,5.43464151269958;5.23456790123457,4.99041113148649,5.03795340891871,4.94331093389220,4.67429236138038,4.83061553260781,4.47312076847405,6.01114033730466,5.27232012760932,5.14892996872302,4.64414319000212,4.96935361773827,5.31484138370796,5.61797752808989,5.60544538607990,4.75124035281147,5.21588661832564,5.25313267426485,5.11194486358631,4.91961251711721,4.92332526230831,5.40435290554282;5.47089947089947,5.16819015356188,4.75967433082148,4.85923687561304,4.61096032053768,4.61968174495555,4.75956252531682,5.81902109443499,5.50161812297735,5.16126139255406,4.86522982418979,5.07191521574565,5.42643073489558,5.45350058458673,5.46897376712213,4.63524439544285,5.80751483190508,4.94616208047352,5.07116349251662,4.58994776081554,5.30853327463497,4.93704296655272;5.38271604938272,5.58534092977029,5.07377150807974,4.87568614788505,4.81452759467494,5.00214410718218,5.27747236849719,5.49151580793233,5.65882912314606,5.23861305113057,4.89170726540987,5.21354789870821,5.62729156703332,5.39999603670016,5.17918218118714,4.61457184858508,5.61140408701384,4.89893583527486,5.06912442396313,4.90439722067252,4.94166850099054,4.56925273679200;5.62786596119929,5.88770525078041,5.74053920015429,4.89944620783351,5.05105337986300,5.14353928352051,5.56102077426075,5.76357728609005,5.62431939140171,5.09175700368822,4.89303113747087,5.03040218798076,5.37541846006695,5.37621623763946,5.21624854682998,4.95107497243660,4.95880026367831,5.51287702285750,5.00387423025162,5.28985139727139,5.51397754787585,4.50434857859894;5.79541446208113,5.78271763931856,5.73365110416179,5.02921268909048,5.39485588729482,5.04039034340484,5.86482263757884,5.76099850430657,5.24777987392445,5.20273981816755,5.39477864859140,5.30389978266709,5.58743822732345,5.32667498959634,5.26679359088841,5.62867511944138,4.97033618984839,5.47194761035199,5.05892908119571,5.71587969772278,5.05539658082031,4.51732941023755;5.45679012345679,5.55034505928300,5.48154679083608,5.17725613953857,5.81103786997544,5.25248310791234,6.20913141600602,5.97374800144412,5.51465513274744,5.25542862908198,6.30825037068418,5.72391394593539,5.46947234178224,5.38017953748291,5.67115394335585,5.71710768099963,5.02966381015161,5.46407656948555,5.23428897679540,5.42678906527362,5.10675764913053,5.60771926788110];
        V4LwholeOrdCurve = [6.17396514444994,7.03909641897259,7.23381004418682,6.76803499755782,7.73604887983707,7.29595474093324,5.47538606737885,6.86624939516444,6.49339906693578,6.46170245592381,7.45168137638253,6.29655714169624,5.65802207666522,6.36892376344356,5.62730908979879,6.93987942076893,6.87494395121514,5.88722883771708,6.80007567317596,6.26785763821465,6.23750734861846,6.10518761533730,6.58647256227253;7.12220282908276,6.39927748337885,6.73492659286359,7.93603601690416,8.56863543788187,6.34500839408505,5.41383413806782,6.73825838575242,6.31969030208782,7.04237204931484,6.99363199642498,5.98504753907414,5.90347419947543,5.68452455564191,5.45326860248542,6.89292489153504,6.11940633127074,5.62946040474698,6.50999516532487,6.08061249965325,6.29629629629630,6.56909985646914,6.70463676324621;7.11959778049861,5.32638382607371,5.05297667125956,7.13754804731466,7.02240325865580,5.11119287997608,4.79831484495753,5.96719059734341,5.99708831022731,7.28221383788939,5.24602199275420,5.85638052929545,6.16856249211047,4.90235403244002,4.81359347806174,6.42525778036549,5.84140435835351,5.22410690819400,6.38807727072079,5.82679131182557,5.92592592592593,6.57422595858110,5.18740842274425;5.93169562612343,4.74641189976170,4.14073264598280,5.89309605215655,5.48757637474542,4.22578938895660,4.93646473074451,5.19456194296596,5.47265327730536,6.06196614163289,4.56612988173708,5.51101118725790,6.48414379286646,4.77324575697561,4.75099996946658,6.80465037657532,5.19572235673931,5.48794048076340,5.98028293359679,5.40653000083220,5.64373897707231,5.77711708017224,4.68639221061587;4.79589444343137,4.50702386263479,3.67273245593196,5.36006285969122,5.20081466395112,3.92452222707725,5.35501785005950,4.80278458488770,5.40316977136618,4.62992832798014,4.47196642035208,4.45865048622586,6.09562814704686,4.77825967058588,6.07767701749565,6.26185601863156,5.07577795713389,5.71235064593737,5.55357030248250,5.45646203778191,5.68489124044680,4.98513430387533,4.94635345275795;4.78807929767890,4.43629557893821,3.91504727514610,4.56157489010172,4.64684317718941,4.00846307752455,5.88573226278570,4.80590631682457,5.31879694272574,4.54016298020955,4.45919849338462,4.20267085624509,5.68887891496136,5.04023665672241,5.61204238038533,6.04962154649438,4.98834185274863,5.71437235913713,5.36648939524520,5.31637493411745,5.16166960611405,4.64681156448637,5.85621780025523;5.00429833016386,4.95097985876106,4.53033686511142,4.47025844677101,4.94338085539715,4.82832371271531,5.71475468136618,4.92921472833128,5.51401250703107,4.70146008948483,4.79595256715132,4.34488176178996,5.20218242001767,5.27338363959989,5.36624835882874,5.85616888605075,5.30333602367501,5.66079695934335,5.13526580203056,5.10277677605481,4.92651381540270,4.86979700635637,6.44940208914307;5.52009794982676,6.07501550581604,5.66826626122488,4.86950243156576,5.71405295315682,5.88965802727503,5.94318073014266,5.39435278692619,5.81345333024518,5.06893698192070,5.57320012129531,4.60492456050058,5.38592086623561,5.53536062573642,5.20136789716345,5.47301992750221,5.73266971572056,5.68505751774053,5.33075483993021,5.10832478016034,4.25631981187537,5.66946893582120,6.54157016590254;5.57219892150989,6.02169726118323,6.76343421865349,5.76143048270297,7.11364562118126,6.87280086470575,6.35626256685224,6.23253781197809,5.40813287893326,5.54020505771631,6.79892111017125,6.44418560554758,5.91609745150567,6.20722504951240,4.98763396537510,5.67210713145390,6.09586584162855,5.63249297454663,5.82683454900889,5.35937196593526,4.18577307466196,5.85400861185155,6.23434324337099;5.58001406726235,6.17838761275721,7.62341426331544,6.50895113508463,8.92708757637475,7.75705448106157,6.64897618624246,6.29653331668410,5.64967078053138,5.96238270894989,7.08141149432625,7.54936750006772,5.89085094744519,6.68480032089047,5.28686146987878,6.12474879326860,5.89745314321586,5.75177405333279,6.27877157211023,5.40653000083220,5.04997060552616,5.73610826327660,6.48721463345465;5.59043426159898,5.64520516642909,7.55214519884069,6.62787487523625,6.98818737270876,7.45693719384587,6.45201001244717,6.08581641094479,6.04010190914204,6.09422556348795,6.36959956589048,7.50467264403933,5.68186599716678,6.85151294843190,4.98458062349241,5.45799447814736,5.34369114877589,6.21777894587874,5.63765160910601,5.61735415684208,5.56731334509112,5.58232519991798,6.08072978210521;5.61648474744054,4.86066528111773,6.35957618662992,5.31121918070038,4.76578411405295,6.06213922682428,6.04850292029709,5.55356111570699,6.10793104589220,5.58929548227836,5.15185853136920,6.47127339707994,5.39573895114801,6.00040111308882,4.87924032853959,5.16312003455853,4.69913012285894,5.88419626791743,5.50312151850840,5.83095231490471,5.99059376837155,5.37984416649580,4.99834570118637;5.61127465027223,4.57666401888989,5.62075355157505,4.41079657669519,3.86476578411405,4.92606305912656,5.09376410565047,4.93389732623660,5.25923965192072,4.88099078502602,4.55176596389869,5.58821139312512,5.11241707224708,5.19942841384843,5.67921590180452,4.53580752399376,4.82355842525334,5.51927703535976,4.92926660080298,5.42733501622791,6.32569077013521,5.22606110313717,4.83055253580375;5.56438377575742,4.89983786901122,4.58022521024374,4.40230202382722,3.14786150712831,4.01191270151553,4.82567125798465,4.81839324457209,4.62065314495583,4.54156556376846,4.24373972580877,4.66451770187177,4.82067969199265,5.01516708867106,6.46545143659736,3.98925680371129,5.18563357546408,5.26454117218931,4.44790112038341,4.95298066520569,5.79071134626690,4.75702275989338,4.81400954766744;5.43934144371793,5.47980979532323,4.33791039102960,4.53821486971480,2.83828920570265,4.14989766115493,5.10060320890725,4.54992429800053,4.68186480494987,4.42795629549630,5.08482691479005,4.47490316114527,4.38868395584667,5.16307754017398,6.97077951818265,3.97798771669515,4.99058380414313,5.33732284738087,4.09265759989910,5.09306776887015,5.59670781893004,5.46698790239902,4.36971215200643;5.32211425743090,5.83562746868913,4.81303748752791,4.79305145575400,2.99633401221996,4.65469263850240,5.65457057270651,5.16022289166029,4.70171723521821,4.82208227555157,5.48701661426497,5.06677140612726,5.13065065851298,5.09037579282509,6.27767091081188,4.05123678230002,4.94686575195050,4.99262074682086,4.49414583902634,5.37878998030459,6.03174603174603,5.41828993233545,4.24209481495486;4.40774220439211,6.26761406295905,5.10524065187438,5.08823716791607,3.94460285132383,5.58609111606835,5.11564923607217,5.41776577645278,5.26254839029878,5.96799304318555,5.41040905246022,5.32952298399112,5.67625566293112,5.42630800471308,5.61051570944399,4.59778750258250,5.76854093803246,5.10280411620808,5.37069346057638,6.12638353352381,5.40858318636096,5.35933975804798,4.94399016873848;4.84018026936202,6.75400702930327,6.29543402860265,5.56180849030559,6.09368635437882,6.89349860865166,5.18130462733726,6.25282906956780,5.93587665023327,6.38456036018346,6.26266817753803,5.64645014491969,5.39994670182476,6.00541502669909,5.95554334218803,5.72657438536521,7.11707470182046,5.29587772678568,6.35444474807138,6.24150461871342,5.92004703115814,6.02316998154603,6.04055395377417];
        V4RwholeOrdCurve = [8.39248847535281,6.39313143275108,6.77904804002331,5.89793329851526,8.49202592484707,5.71296708368360,6.17337286039895,5.97326552512481,6.43080776455855,9.16080484213970,6.23803446075303,6.58954870192561,5.53900927732703,6.41628812459442,6.26318565400844;6.38451313668373,5.08524755751380,5.99545920315043,4.55495038424233,7.16483396446257,4.68773179053553,5.83520788952285,5.94527131059581,5.46649968691296,8.45920351891234,5.36375239310785,5.63288806192842,5.37468761767827,5.78628596149686,6.01265822784810;4.57874939902147,4.36425697915397,4.91049004440337,3.53652167425203,5.30603699388290,4.64982116072459,5.37935554992775,5.62450426911772,4.24546023794615,6.36530526928040,5.30312699425654,5.39942775895663,4.50857553661292,5.51319489508977,5.78850210970464;3.86323142622812,4.41998571951028,3.84561290711458,3.34813101544430,4.48860326245267,5.19210799584631,4.78198042516424,5.18709466710213,4.17658108954289,5.11841794354472,4.54690491384812,5.43102389018589,4.93649652528157,5.10491023145144,6.05661040787623;3.69637150371900,4.82227756395744,3.84159450282293,3.87226740282026,4.07806583163414,5.05694835912905,4.98011232440002,5.16959828302151,4.75767063243582,3.98604067833579,4.66496490108488,5.10979655602170,5.00496388346856,4.89941596365996,6.57964135021097;3.98766933454000,5.41439543024329,4.04653312169737,4.15019025591286,4.08807893970288,4.87398836308494,5.83818731657902,5.52885736947698,5.04821540388228,3.93151207808496,5.22016592214423,5.56442977759834,4.87829927082264,5.13735669478694,5.89398734177215;4.93933651969796,5.49276397136936,4.26151775130096,4.57360292471835,4.48769297990096,5.12452817748768,6.34915905671339,5.32823216535249,6.02254226675016,4.20051983932239,6.78366305041481,5.93831733047798,5.19667248639211,5.22388059701493,4.75562587904360;6.07341836590401,6.05701746747706,4.45841956159209,4.76758934566888,4.96012962423536,4.94980962270682,7.90144055298166,5.56268371203285,6.71008140262993,4.87849210244106,6.52839821314614,6.37890782706384,5.34387730649413,5.77006272982912,5.02373417721519;7.28810203908482,5.97690740321485,5.47105744308935,5.90539431470566,5.72294640256336,5.38825429791162,8.92189431972232,5.85545653898194,7.24358171571697,5.78003162658815,5.42437779195916,6.06119117414734,5.42603813631851,6.13508544235345,4.86990154711674;7.11417178087616,5.55197575799795,7.15677804343895,6.83988659255391,6.02333964462569,6.35085463745900,7.75246920017281,5.80879951476695,6.33562930494678,6.49617390988240,5.13082322910019,5.50123751513981,5.55954948478313,6.07019251568246,4.80397327707454;6.16816086427784,5.83584402918793,8.36631773522734,7.31552637469223,5.86312991552578,6.69699517051542,5.87840958183741,5.47636821723510,5.19223544145272,6.15446134831052,5.04786215698787,5.13963734662711,5.65198041833556,5.57538394981614,4.69409282700422;5.10054017364745,5.39001410633740,8.40449257599807,7.33604416921585,5.36156422953685,6.55853895729285,4.71196388934408,5.41571408575561,4.64746399499061,5.47648908519185,5.34141671984684,4.77803717811441,5.94296669063024,5.23469608479342,4.43917018284107;4.61551514465907,5.49624701764163,6.97996825460610,6.52279340446169,4.75349548499854,6.22723301851028,4.11160933752439,5.43670974665236,4.19787100814026,4.54223240089427,5.98596043395022,4.83069739682986,5.84368902125912,5.15357992645468,4.43037974683544;4.33694391809723,4.95463332230369,5.97536718169215,5.87181974184884,4.74712350713662,5.81680924360052,3.67512327379445,5.10194559790977,4.72510958046337,3.92424159805151,6.51563497128271,5.21687233407643,5.50135223032419,5.26714254812892,5.04571026722925;4.27048276252156,5.13923477473398,5.04711579031966,5.59949265089905,5.05570929216429,5.20199772536221,3.62745244089562,5.37955489198899,5.43644333124609,3.83517821764182,5.64773452456924,4.99394407484772,5.95666016226764,5.28606965174129,6.00826300984529;5.17548573206256,5.99954720398461,4.34992264571739,5.89047228232485,5.29420332071075,5.20529430186751,3.96561741177172,5.43904259786311,5.82216656230432,4.38228184015850,4.85003190810466,4.73239832189436,6.27161000992777,5.44289422452953,6.59722222222222;6.45663056081903,6.92081294299995,4.45641035944626,6.94434081921958,6.40565831634139,5.80856780233727,4.58384852592846,5.52885736947698,6.69630557294928,5.48557718523366,4.97128270580728,5.74698520247854,6.67214405532163,5.74302401038287,6.49173699015471;7.55818886280721,6.68570731962174,5.65389483835969,7.07304334850407,7.70736236527818,6.49755229194482,5.53279604332087,6.23804413754491,6.84533500313087,7.82303651598597,6.43586470963625,6.95465955168601,6.39142788675499,6.24053644819381,6.24560478199719];
        V2LwholeOrdCurve=  [6.45151730678047,5.78066056938150,5.11906459432483,5.65967986396067,6.59925778518798,4.80679507118076,6.13952635319471,4.75664480497066,6.93597726335886,6.28552191219280,5.22889114954222,4.92770128734417,7.12536375947215,5.71310667369724,4.30133956003441,6.85325841917248,5.47092226355982,6.38684729442495,7.19176742184138,6.72386543237751,5.51857585139319,5.35747619936532,5.34633905420422,6.25037454305747,7.34370510241780,5.34199022885060,5.14846518044712;6.91974869606449,6.57041278801531,4.79585531631732,6.59495027910244,7.29844565158931,5.10108864696734,5.94007198697815,5.80600621332413,6.50207189811902,6.04788403271482,5.20345879959308,4.80771186268329,6.39064165730256,5.82773561979871,4.76219737003810,7.44979710748101,5.06363814372430,5.34200619734180,6.59310560707438,7.15737186723866,5.71207430340557,5.83908904237446,4.96974935177182,5.93276203032301,6.88395386067895,4.64772435073284,5.02304580942527;6.58487434803224,6.52427606046625,4.34906602024811,7.82595837492145,7.09944602807508,5.90501256131116,5.72227698938536,6.63790127718329,5.39778274358362,6.47959284709983,4.70498474059003,5.32020906631958,5.51185639784482,5.69018088447695,5.06943591004056,6.30874345368155,4.33522616017231,5.05518707265231,5.49751535782760,6.70128697222850,4.59365325077399,5.70468545827889,4.71045808124460,7.16126325882423,6.38315340092771,4.62201079969144,5.03558774652745;6.42188240872451,6.29359242272098,5.15233613764913,6.53580274296699,6.19050180175335,5.85955257805958,5.49989683394851,7.43527787366241,5.27628924131647,6.27364001821890,4.97456765005086,5.28360212320270,5.64151323940416,4.92445952451913,6.05259923804842,5.13300731800368,4.70334834540826,4.42008758226843,4.57408929060531,5.42786181982389,4.73297213622291,6.12282994213179,4.77219409803679,5.91478396356445,5.66068716390953,4.69915145281563,5.63132975888126;5.03793266951162,5.24601731484246,5.24739769000428,6.35096669254371,5.82477276394342,5.65857159947362,4.82817120979390,6.13393165343459,5.28496734862127,6.77069924946036,4.72533062054934,6.07065140021557,4.02800587777682,4.37882574107614,5.79759124984638,4.88329344847917,5.08713530448404,5.00396937181490,4.49583284423054,4.44795664935651,4.90325077399381,6.89565055068135,5.14261019878997,5.46533229460059,4.66729608800952,5.21985086140396,5.06067162073182;4.61415362731152,4.55396640160664,5.05727458529398,6.60234372111937,5.27617920722853,5.40734537624118,4.79607510488549,5.60234725578184,5.16347384635411,5.27160029308672,4.92878942014242,5.10666856480446,3.22125219696315,4.99782205002407,5.53951087624432,4.10293760621510,5.08321911102408,5.35737150759302,4.22193528191885,4.28539173628359,4.33436532507740,5.83162217659138,5.38338066427954,5.48331036135914,4.05566273962481,5.65698122910774,5.22371680306023;4.45116168800379,4.20658398241377,5.41850848424355,5.50811430261358,5.34071962566557,4.31152051680823,4.78461221027534,5.97514670348637,4.77078949081205,4.73493474859893,5.14242115971516,5.03955583575685,3.92139914138358,5.52511520209083,5.61939289664496,4.53300038150730,5.41217936166047,4.81446387871648,4.34323277379974,4.85888462406864,3.79256965944272,4.78252753406758,5.13643659711075,5.45933960568107,4.31837773490415,5.58626896374389,4.99169096666980;4.67045993361783,4.65166770700464,6.56400019012311,5.41199955639348,6.20663690636261,4.46704151214260,5.09869552259337,6.51363479461512,5.05499750504415,5.03792304493336,6.64292980671414,5.14937666510748,4.79154061140404,5.89422040853756,5.69005776084552,5.73301425450005,4.78950460152732,5.22932725549950,5.95140274680127,5.75750733799955,4.58978328173375,4.80866156430838,4.57463884430177,5.02786600347576,4.89306678707771,6.27410645410131,4.51823284106230;5.54765291607397,5.47670095258773,6.26455630020438,6.37314701859451,6.07217770128543,5.62986003110420,5.32107567803022,7.24197445633414,6.54546243464300,5.39636017981266,7.01932858596134,6.58518232291391,6.63266776154666,6.44443934982462,5.93584859284749,7.01973433218881,5.94869786567456,5.79016107966913,6.71049027663654,7.13930909911944,5.58436532507740,6.53724099309315,5.30312384244968,5.03985138131480,6.48577644595871,6.06196965800977,4.96033612391434;6.51671408250356,6.32073167422043,7.35776415228861,6.28072899338287,6.12596138331630,6.34047134824740,5.68788830555492,7.77701070072489,8.22467619812119,5.76865952432818,6.69379450661241,7.58780582050396,8.82819027861815,6.48799834934318,8.49821801646799,9.17351645683765,7.10397493636186,6.69671438449128,7.41871111632821,6.92707157371867,7.03560371517028,6.38043681164831,6.37115693295469,6.37022832144783,7.79524650055417,5.66983800462844,6.77578151945568;5.93883357041252,6.57312671316525,8.17054042492514,5.34545857824110,5.43753025332114,6.90752482354349,5.53428551777895,6.25819813600276,6.77109322456772,4.63591896548310,6.29704984740590,7.76677309796425,8.04448670297058,6.44902450766868,6.27381098685019,7.57465404224326,7.33111415703936,6.29721631795949,7.19959306647885,6.17295100474148,6.66795665634675,6.52230726152698,7.00086430423509,5.19566129322227,6.90447846968515,5.55412702494215,6.65976860126046;5.77880512091038,5.71824029093278,8.40344122819526,4.32516357990463,4.20588393481418,6.58451967938749,6.32293266695706,4.81532619951674,5.24157681209728,4.80226548111769,5.36622583926755,6.09708974802221,5.89218313308554,5.73373988399551,5.81295317684650,5.29254673464433,5.45917368317995,5.95917949243259,5.79880267637047,4.39376834499887,6.55185758513932,5.26414037707672,6.31559451784171,4.87205609156829,4.90127663068019,5.27770635124711,7.07365252563259;5.80547652916074,5.68838711428339,5.00023765388089,3.54145872610994,3.82939816059807,6.44096183754038,5.94924230266627,3.96617190196755,4.81201050050984,5.07950967384201,5.26958290946083,5.42799617660816,4.99611029475322,5.05284394415278,5.95428290524763,4.82433322928589,5.27119639710202,5.62882532203129,4.43322768713073,4.46601941747573,6.35835913312694,5.29774127310062,6.96999629583899,4.96793911428058,4.65908624440704,5.39984571869375,6.31486533095037;5.37873399715505,5.92449860232855,4.41085602927896,4.05160622527818,3.93158715645673,6.03182198827611,5.18122836378642,4.04901622367967,4.57987113010652,4.78840327148147,5.74262461851475,5.14530922698339,4.61866482265825,4.80983057841766,5.68698537544550,3.90524745950820,5.23595065596241,4.89641220005634,4.82450991900458,4.26732896816437,6.25386996904025,5.19320515213739,6.09951845906902,5.48930305027866,4.80686342925167,5.93340190280278,6.48104599755432;5.19203413940256,5.55540478193611,4.31104139930605,5.04602417655540,4.25966761684505,5.57004426366790,5.32795341479630,4.27338626164998,4.54732822771354,5.29734439669683,6.19532044760936,4.76500376238027,4.32765724493618,5.19498383731860,5.77301216664618,3.93646169319877,5.70197767769728,4.66081077620426,4.68364831552999,4.47505080153534,6.26934984520124,4.50998693298488,5.95135201876775,5.06981482591239,5.00800459751242,5.88197480071998,5.54040071489042;4.59044570886676,4.81450321600130,4.33005370977708,4.87227828915752,4.65228849567041,5.01495394185907,5.42653430844357,4.43217121159821,4.39112229622719,5.50725785690239,5.71210579857579,5.18191617010026,4.31901345549889,5.66725509525665,4.75912498463807,3.69021607186210,6.22674760133151,5.76711311429230,4.35497124075596,5.08466922555882,5.65015479876161,4.80119469852529,5.10556858871466,5.32150776053215,4.33890234391035,5.91411673952173,4.96660709246543;4.79196301564723,4.73579938665292,4.57721374590047,4.51739307234483,5.11482816113591,5.05802129441321,6.08908961691006,3.59682430100104,4.65363504219730,5.23595461116502,4.92878942014242,5.08429765512192,5.50033134526176,5.70393635800912,4.31055671623448,4.15149308084487,6.25807714901116,6.19478091628467,5.33708964275932,5.22465567848273,5.82817337461300,4.85719619189845,5.07470058031856,5.02786600347576,4.89717170887895,6.08768320905117,5.06380710500737;5.30761024182077,5.36543002144001,5.47079233803888,5.15692580680936,6.53471736675093,4.90489292977629,6.35044361402141,4.72903003106662,5.84687479660686,6.58652989286492,5.22380467955239,4.65314921396758,6.20912207911949,5.50448199179257,4.16308221703330,5.43474491034579,5.51791658507930,6.49952623626725,6.37007473490629,6.48904944682773,5.62306501547988,5.29400784020907,5.77231757007038,5.95074009708156,5.99729075161118,6.17125224993572,5.53099426206378]     ;
        V2RwholeOrdCurve= [6.01978115861072,6.14310913413605,5.34087569791361,5.20317888738941,5.24642289348172,7.09934395501406,6.84022800760025,5.75550223644065,4.75322490185081,5.25781910397295,7.22029436400622,6.35945315105035,5.98911550248336,5.33323710893804,5.39910407879915,6.28695795006570,5.82373000940734,5.95385760357231,6.90469701099301,5.01688374336710,5.04426713302000,5.46033008550408,5.55538727168085,5.19249753208292;5.75362271218743,5.06557251322954,4.99804094426486,5.42810016494227,3.54782026608652,5.52952202436739,5.46684889496317,6.16131994431115,5.38418395961862,5.17328825021133,6.35156156515496,5.52450816938980,5.81475219275071,4.08472558005268,5.19739082597648,6.22946780551905,5.44449670743180,4.83750930290251,6.78659035159444,5.10800235836415,5.18635916493606,4.99105189898588,5.70381364916851,5.34386311286607;6.03292478559459,3.83081524656799,4.11401704378490,5.04466293939978,4.57702284327671,5.03414111661534,4.18680622687423,5.50667970022809,5.55711347915498,4.84868977176669,4.91085317697738,5.37645881960654,5.50301172989538,3.85378703135712,5.14237812066120,6.57851511169514,4.59195672624647,4.43231621599272,6.77296266012537,5.53143592217398,5.14263853973112,4.18373434082323,5.41301911368249,5.20565975649885;4.92557421220386,3.87683104532556,3.91076501126457,5.44523702418439,6.30909547318216,4.78645066273932,4.21680722690756,5.62812879528422,5.22994952327538,4.50718512256974,4.36041641737466,4.79493164388129,5.92835253090986,4.16771912099015,5.89421842663663,6.36908672798949,4.56549858889934,4.07673860911271,6.42772780957573,5.11872219542263,4.95682588261012,4.35076555975343,4.83748826219974,5.06087528792366;4.62655669832090,4.57090267658563,4.55970222352826,5.61660561660562,7.59769056982679,5.86758602222520,4.89349644988166,5.74365354424005,5.74873808188446,5.15300084530854,4.68828526983367,4.59619873291097,5.08031279721019,5.15281636776964,5.85492363712572,5.26445466491459,4.50964252116651,4.18010419250806,7.44980466975561,5.27415983277054,4.96229096076074,5.03479817061046,4.82537182322116,4.63968410661402;4.25196332928072,5.31865940639620,5.34577333725145,5.57162136109505,7.19605053970379,5.23162404605704,5.08350278342611,5.70218312153796,6.50121518040755,4.93998309382925,5.51154720593514,5.04968322774258,4.02092359716792,4.65485512214484,5.63225316323056,4.28301576872536,4.10983066792098,3.98577689572480,7.66330516943763,5.89055046363295,5.63996065143732,6.47842513422151,5.66140611274347,4.68575189206976;3.92994446817599,5.73280159521436,5.39719855029876,4.80903112482060,6.99523052464229,5.25505422412639,5.42351411713724,5.54815012293018,5.52439708356702,5.34911242603550,6.78951776953452,5.50050016672224,4.12395646200993,4.93270306354419,5.92827391087942,4.12286465177398,4.71542803386642,5.17241379310345,7.06822930862179,5.19376105483197,5.51426385397311,6.78067210180951,5.81589070972041,4.17900625205660;4.41954457332501,5.91686479024465,6.11225389362327,4.90542595805754,6.50991548824366,5.88097469540768,5.55685189506317,5.22823543351403,6.80501028229576,6.20794590025359,6.62199353835108,5.61653884628209,4.51759484307302,5.09147331577238,7.00233149084431,4.48012483574244,6.12358889934149,6.33010832713140,6.95466521304624,5.67615372246342,6.49251284293365,7.46868164645059,6.07336503801533,4.80421191181310;5.36588571616338,6.73747986808804,6.45753746694093,5.73656363130047,7.30482804786210,7.44075512116749,6.51688389612987,6.15835777126100,8.68386614320434,7.28655959425190,7.89517769534522,6.05535178392798,4.93501003909965,7.08331829827157,8.03709428129830,7.60101839684626,7.71989651928504,8.53386256512032,6.93195239393114,6.53374068714156,7.96261886544978,7.25392722211175,7.50007572774362,7.62750904902929;6.79525515065882,6.42303857657796,6.79057694191400,6.38348006769060,7.23788804284160,7.10603829160530,8.40028000933364,7.87938031339791,9.27743503458590,7.95266272189349,8.06748833313390,5.83127709236412,6.32727464863151,9.15454840688486,6.84253268016661,8.06915243101183,8.14322671683913,8.88530554866452,6.33687653311529,7.04829286594844,7.39971581593617,7.58003579240406,7.75755005603853,8.28562026982560;7.15999079946111,5.09624971240126,5.93838769712998,6.01932180879549,5.00376537528240,4.72954880171375,6.27354245141505,6.45161290322581,5.83286595625351,6.51563820794590,5.90403254756492,5.26175391797266,7.69576244319983,8.23079421210263,6.04091897414403,5.14126149802891,6.45578551269991,6.20606962705698,4.76514945034978,6.94109449536367,6.33949065471636,7.28971962616823,6.02187017235634,7.76571240539651;5.89820260900996,5.25347035815630,5.73023802527182,5.54377396482660,3.81558028616852,4.17057169634489,4.47348244941498,5.49483100802749,4.41671340437465,5.18681318681319,4.33887758765107,5.00833611203735,6.36954454190003,6.05492007361166,5.56414219474498,4.34461235216820,5.24165098777046,4.47779707268668,3.33424184609794,6.62485930213861,5.37217182205706,5.60747663551402,4.83748826219974,6.23231326094110;5.51046561298590,5.36850985505023,5.28700166519738,5.58018979071611,3.94946029620952,4.38479046726469,3.87012900430014,4.94090464764952,4.30454290521593,5.12595097210482,3.83151848749551,4.90030010003335,5.23354116030857,4.58990365532422,5.12927985749090,4.46780551905388,4.72130761994356,4.22145042586620,3.06623058053966,6.49622125743689,4.68903705322986,5.46430701928813,4.59515948262806,5.09378084896348;5.64847369631650,5.46054145256538,5.73023802527182,5.60161086476876,4.36783532758765,4.90694872138171,4.16347211573719,4.34254569151930,3.79042811740512,5.04480135249366,4.07083881775757,5.20440146715572,5.31279721018704,4.64763829249811,4.56343488853378,4.51708278580815,4.94767168391345,4.17596956917225,2.99809212319433,5.82623144128209,5.25740518089409,4.46211970570690,4.85566292066762,5.32411977624219;5.82591266059869,5.98972313827748,6.07062395925164,5.93363751258488,4.21722031629152,4.41826215022091,5.58351945064836,4.15000444325958,3.64554122265844,5.03803888419273,4.13066890032308,5.60053351117039,5.91778505759273,5.01208818965828,4.21240143556964,4.98521681997372,5.31220602069614,4.87885553626065,3.38875261197420,5.04904325454253,4.90217510110395,4.36269636110559,5.69169721018993,4.94899638038829;5.52032333322380,5.88618759107294,5.93593887746106,5.57162136109505,4.53518534013890,4.61239791136698,6.27354245141505,4.79279599514204,4.42138717517293,5.24429416737109,4.23596984563839,6.06068689563188,5.73021240621367,5.74459639880201,4.10499567757315,5.41228646517740,5.56208842897460,5.16414454643182,3.64767874988644,3.93418020046095,4.57973549021751,4.00874925432492,5.16160300487687,4.84369858506088;5.94420530345349,6.35018022854513,6.22000195905574,5.95720069404280,4.75274035645553,5.90775204177266,6.03020100670022,5.55999881513078,4.77659375584221,5.38968723584108,4.57341151130789,6.58352784261421,6.05780407904470,6.24616605925017,4.53199905692505,5.83114323258870,5.84430856067733,7.41337964111469,4.40174434450804,4.00385914134105,5.36670674390644,4.53768144760390,4.68300366522279,5.56103981572886;6.37137318042914,6.97906281156530,6.06082868057596,5.64873722768460,6.83624801271860,7.63823805060919,6.74689156305210,4.95571551290026,5.34679379323238,5.77852916314455,6.49754696661482,6.67555851950650,5.44224875832189,5.96470970302746,4.92232729940010,6.01593298291722,6.16768579492004,7.07434052757794,5.10129917325338,4.73280806131747,5.19182424308668,4.68482799761384,5.01014751764456,5.20565975649885]      ;

        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
        temppara = load([Resultfolder,tempname,'_parameters_3peak_fitnlm.mat']);
        para = temppara.para;
        temppara = load([Resultfolder,tempname,'_parameters_2peak_fitnlm.mat']);
        para2p = temppara.para2p;
        temppara = load([Resultfolder,tempname,'_parameters_1peak_fitnlm.mat']);
        para1p = temppara.para1p;
        temppara = load([Resultfolder,tempname,'_statc_lratiotest.mat']);
        LRT = temppara.Usta;
        tempUyy = load([Resultfolder,tempname,'_yyCombined_yyCardinal_yyRadial_fitnlm.mat']);
        Uyy = tempUyy.Uyy;

        if inN == 1
            V1Lpara = para;
            V1Lpara2p = para2p;
            V1Lpara1p = para1p;
            V1LUyy = Uyy;
            V1LLRT = LRT;
        elseif inN == 2
            V1Rpara = para;
            V1Rpara2p = para2p;
            V1Rpara1p = para1p;
            V1RUyy = Uyy;
            V1RLRT = LRT;
        elseif inN ==3
            V4Lwholepara = para;
            V4Lwholepara2p = para2p;
            V4Lwholepara1p = para1p;
            V4LwholeUyy = Uyy;
            V4LwholeLRT = LRT;
        elseif inN ==4
            V4Rwholepara = para;
            V4Rwholepara2p = para2p;
            V4Rwholepara1p = para1p;
            V4RwholeUyy = Uyy;
            V4RwholeLRT = LRT;
        elseif inN ==5
            V2Lwholepara = para;
            V2Lwholepara2p = para2p;
            V2Lwholepara1p = para1p;
            V2LwholeUyy = Uyy;
            V2LwholeLRT = LRT;
        elseif inN ==6
            V2Rwholepara = para;
            V2Rwholepara2p = para2p;
            V2Rwholepara1p = para1p;
            V2RwholeUyy = Uyy;
            V2RwholeLRT = LRT;
        end
        
    end
    %%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% load shuffled data
    for shuffleload =1
        
        V1LshuffleOrdCurve = [5.46921661120659,5.58967657628226,5.39469780267728,5.55774969282078,5.50663645192619,5.55424561668254,5.43080761475102,5.42276767981153,5.41124658483872,5.49817668509587,5.55758792181212,5.61621230616212,5.68694013328943,5.55939567492841,5.50083588001661,5.63794267885510,5.62720440828053,5.66936539090612,5.50436910171269,5.49051117232935,5.66226648749769,5.47518618598827,5.70353608331743,5.55424561668254,5.55758792181212,5.63794267885510;5.48993795785034,5.65828160731787,5.35281079288619,5.73876601720204,5.44404877522391,5.59763079215672,5.58973307358420,5.43920445984632,5.49008413869972,5.51229267145042,5.51606173559684,5.48510330485103,5.56886431498995,5.49644514663770,5.46143771362857,5.51999010720367,5.57467382797843,5.64687602224403,5.42467668647326,5.52877257422712,5.48309751534793,5.33183945165755,5.61765587938602,5.59763079215672,5.51606173559684,5.51999010720367;5.72274838190661,5.41326363933355,5.36153725325933,5.62028260487976,5.64799827344340,5.61177813198525,5.46413069482894,5.67068911200296,5.48872487052971,5.41818609575344,5.44685142523803,5.54161580541616,5.65401514549439,5.50014811889009,5.55301183009807,5.51333149428786,5.61326772371059,5.62949787373242,5.26948619363859,5.34703091521273,5.56741232577135,5.43893758650234,5.56176558793860,5.61177813198525,5.44685142523803,5.51333149428786;5.65205202276910,5.39202874877491,5.36502783740859,5.52812883974022,5.44944426459480,5.52123515708263,5.50001708875902,5.62137877189859,5.65727412361185,5.42524408893071,5.37269752128217,5.67611555676116,5.40423937601472,5.53717784141404,5.49657661878547,5.61416191844150,5.35919124347388,5.62949787373242,5.48339741349179,5.46181512090603,5.63064843358891,5.38456468727345,5.61083999018512,5.52123515708263,5.37269752128217,5.61416191844150;5.48384344413159,5.61581182620059,5.55875525769238,5.57530279094260,5.50232006042948,5.43635111811143,5.51368809597047,5.51316997000288,5.71300411858256,5.70285848723680,5.36182161536864,5.67159455671595,5.46441262957118,5.54458378591883,5.52532663209566,5.64745498302054,5.46103624610041,5.51909551848217,5.43306536176162,5.45990205081114,5.42249624535610,5.69103011929085,5.63810354698874,5.43635111811143,5.36182161536864,5.64745498302054;5.50822149900659,5.48186867036916,5.66696336631935,5.47546954537476,5.52498111578720,5.62969809576806,5.56153662121057,5.64740367362034,5.52542511112017,5.48406069874133,5.60306898290505,5.61621230616212,5.54388673804199,5.53224054507751,5.59453962710168,5.64935744385362,5.53393582692782,5.60700850507033,5.56588605382733,5.55555555555556,5.42776592100756,5.90357872536743,5.68036206003435,5.62969809576806,5.60306898290505,5.64935744385362;5.50334588803159,5.64521398235871,5.49767003508037,5.69268913463226,5.41707132836948,5.63630018768804,5.56837212481630,5.55974084676812,5.50095828405986,5.40877543818374,5.66140338735033,5.55856955558570,5.56545828176978,5.52360027648859,5.59028036587054,5.57135654969703,5.51999914235787,5.52625122669284,5.51415588954911,5.62251300887665,5.50681105577952,5.43564225927635,5.45271136072412,5.63630018768804,5.66140338735033,5.57135654969703;5.58988798283785,5.70728520091473,5.72630329685673,5.49741091802703,5.51311103917125,5.63630018768804,5.58460644587990,5.49673318996809,5.55261047452052,5.78990706975650,5.55363304693448,5.49527555495276,5.49052555092588,5.64703268490175,5.50083588001661,5.51142903345477,5.48890961524030,5.46900556100752,5.57846906675988,5.55938169574533,5.50417621795379,5.34666842417452,5.41045284767851,5.63630018768804,5.55363304693448,5.51142903345477;5.47531112492534,5.52597190460634,5.66696336631935,5.33065648586976,5.66526383943024,5.58254029633961,5.55640999350627,5.49947265330722,5.64639997825171,5.74755911069286,5.75038807209737,5.63542655635427,5.70737633261050,5.48657055396465,5.54449330763579,5.37730554472210,5.45889214078196,5.56202976774616,5.53372946522195,5.59190388735843,5.57531683924854,5.62841890199697,5.52223343057335,5.58254029633961,5.75038807209737,5.37730554472210;5.38755012737534,5.63541326363933,5.75248267797616,5.65538880112340,5.67821301392036,5.45898686183708,5.68713899996582,5.87203966742915,5.53629925648031,5.58757793200800,5.64855004399798,5.63768705637687,5.56772897058323,5.42485434975807,5.78620638250296,5.65506482635289,5.66794240933115,5.66016519463526,5.69451240824886,5.76025405570860,5.69915421705794,5.67290581954788,5.55494969873770,5.45898686183708,5.64855004399798,5.65506482635289;5.67277336941286,5.63377981051944,5.66696336631935,5.49411971212919,5.63612819682745,5.40522697048865,5.60596739464780,5.55015272508116,5.64096290557164,5.63463121985649,5.55066689077624,5.42633030426330,5.44170574143667,5.69023402784635,5.66801188333884,5.47718473845920,5.59289872318528,5.38518155053974,5.69451240824886,5.51729415365779,5.55950781229415,5.45870954985830,5.46770631696611,5.40522697048865,5.55066689077624,5.47718473845920;5.70690264623786,5.58640967004247,5.69488803951341,5.65868000702124,5.53900938815151,5.54009827685401,5.60511295669709,5.59398413850727,5.60426266498117,5.65345253499588,5.61394488881858,5.57100230571002,5.48484882889225,5.50014811889009,5.77981749065625,5.59799100136026,5.62827646093976,5.50989532221132,5.74204823488291,5.75068870523416,5.59903037968013,5.50484413102221,5.54813380953679,5.54009827685401,5.61394488881858,5.59799100136026;5.53991297034410,5.52923881084613,5.57271759428940,5.55774969282078,5.66634293730441,5.69571901496789,5.48976383335042,5.57754735847248,5.55668827903057,5.54758263733678,5.65645979375328,5.62412405624124,5.59611258075137,5.52236595240446,5.52852107801902,5.59799100136026,5.43852314025665,5.57225220804710,5.58406151695212,5.53833792470156,5.70705873053514,5.74210769129375,5.51269118569208,5.69571901496789,5.65645979375328,5.59799100136026;5.57526114991285,5.35282587389742,5.52210412412517,5.57091451641215,5.62965360958239,5.51086044120837,5.57264431456988,5.39948224142890,5.44794682542919,5.67462651452770,5.53979098486272,5.54274605542746,5.57113500380341,5.57050459168559,5.55620627602142,5.53901471553454,5.65078956678352,5.59065260058881,5.59105207969242,5.51729415365779,5.48309751534793,5.79153759968365,5.62310859074675,5.51086044120837,5.53979098486272,5.53901471553454;5.43508733438159,5.56517477948383,5.59191580711032,5.50618746708794,5.69116218841049,5.55518877267111,5.64698041628217,5.42824660648979,5.66814826897199,5.45818139042466,5.62383207601270,5.53935530539355,5.65515048990111,5.44213488693591,5.62222482510409,5.54091717636763,5.41601003441289,5.46389434085705,5.55749737853897,5.49242424242424,5.55950781229415,5.67455348316088,5.52087025273317,5.55518877267111,5.62383207601270,5.54091717636763;5.53625626211285,5.51290427964717,5.60936872785661,5.56542917324908,5.57138232437682,5.54198458883115,5.52052359957620,5.58028682181161,5.52542511112017,5.68403717209740,5.52792636022978,5.47945205479452,5.59384189193792,5.67418781475264,5.55727109132921,5.37445185347247,5.68616730453800,5.49353941772980,5.85249912617966,5.59764309764310,5.52788975838537,5.56580768470309,5.58085007770114,5.54198458883115,5.52792636022978,5.37445185347247;5.61060932948160,5.61907873244038,5.56399113391626,5.46449885904862,5.48181720082012,5.52783724900261,5.58631532178133,5.36523894968976,5.49280267503976,5.23232560875191,5.50914070456096,5.43198155431982,5.46554797397791,5.64826700898588,5.44227103808844,5.53520979386837,5.62184414498440,5.46389434085705,5.59944075498078,5.77173247627793,5.53315943403684,5.47353852237527,5.47179585048665,5.52783724900261,5.50914070456096,5.53520979386837;5.64108189807535,5.53577262332571,5.43483952039374,5.51057574161840,5.43541599223050,5.55801824063682,5.51625140982262,5.76246113386388,5.54173632916038,5.54052464415951,5.50617454840273,5.45119580451196,5.53821001600836,5.70010862051940,5.29213207969078,5.63984513968819,5.66043804071656,5.60189728491986,5.37714085983922,5.43694520967248,5.55160329881696,5.48012917682726,5.52223343057335,5.55801824063682,5.50617454840273,5.63984513968819];
        V1RshuffleOrdCurve = [5.61848973172566,5.59644232877141,5.64464400256575,5.54848653201670,5.44081174811933,5.52686458957996,5.72399955411883,5.38154940977047,5.50896522685007,5.70532427808595,5.59348232111805,5.55548414463283,5.52274781560711,5.31294022942242,5.50569075599149,5.47076451320650,5.52794888822735,5.80780084660351,5.75113920329266,5.38154940977047,5.55548414463283,5.31294022942242;5.60025528229207,5.41323478751057,5.65027064132429,5.48486532016703,5.42125899169523,5.54745048197839,5.49130531713298,5.58007421773590,5.44229622092003,5.65866556068225,5.51619759129259,5.52077843618648,5.48056643567340,5.63270052100803,5.43397797723698,5.71003786558878,5.25773431954018,5.42229389236041,5.62251947670146,5.58007421773590,5.52077843618648,5.63270052100803;5.63444487498006,5.67943377908615,5.69865973464772,5.68289754296672,5.49535364761817,5.55819094757758,5.47597815182254,5.49455583892002,5.70809502087793,5.26897886532912,5.39060990532621,5.49892669383138,5.57999397408858,5.61481183336688,5.45942444711761,5.44288800613283,5.25773431954018,5.61378754283411,5.40080356705375,5.49455583892002,5.49892669383138,5.61481183336688;5.52047956602010,5.65281387992860,5.55574311018084,5.56730407354971,5.59826289195559,5.60920815917370,5.63900345557909,5.61061649588443,5.52826414961929,5.44351703043185,5.60314291234624,5.50021209044050,5.42332027719192,5.67965832606606,5.61904321273249,5.62176225985551,5.51878907233965,5.57347309010280,5.54534764074673,5.61061649588443,5.50021209044050,5.67965832606606;5.57860187358968,5.58234944098212,5.63901736380721,5.51443574257603,5.48197544585430,5.49732830918220,5.57212127967896,5.63046897668097,5.59054703673813,5.77617640451380,5.72551040123656,5.48221653791277,5.71256402530883,5.51642405134053,5.68612936059961,5.58691662601343,5.69053562023403,5.58355170328563,5.66049291979029,5.63046897668097,5.48221653791277,5.51642405134053;5.50908303512411,5.44768406877329,5.43983435175495,5.54490223839137,5.53343006802301,5.58056691757588,5.47597815182254,5.59534535681016,5.55107196743746,5.49190384848014,5.73195079538868,5.59147524968829,5.89635432359144,5.48288276201337,5.57971685018969,5.51257927381699,5.44093063729419,5.70449506147954,5.66661766867558,5.59534535681016,5.59147524968829,5.48288276201337;5.55694846488729,5.61993047508691,5.40044788044518,5.42124410831735,5.45624813476995,5.60920815917370,5.48991193846840,5.64726722966266,5.65984771395488,5.34415124336841,5.51297739421653,5.38709718883762,5.96565230491112,5.43592495695535,5.49875080966041,5.29653634399610,5.49817948659232,5.67173956863536,5.43755206036552,5.64726722966266,5.38709718883762,5.43592495695535;5.49084858569052,5.51814850771977,5.47697016756130,5.47411243929103,5.50873184938203,5.58325203397567,5.61113588228737,5.62283340714384,5.52300080704586,5.42623602398604,5.55806015328138,5.56962350733319,5.91744501355830,5.41580018335905,5.41084482280004,5.34299718911887,5.27834390528750,5.56843378351139,5.29300798667255,5.62283340714384,5.56962350733319,5.41580018335905;5.58999840448568,5.42106416961573,5.48147147856813,5.68737790999839,5.49947001739166,5.71303265996581,5.47876490915171,5.80455996212757,5.61949542089196,5.66039366132683,5.45501384684743,5.42565908711133,5.71557698101838,5.50747970751996,5.54270380309059,5.43359583710828,5.59893746135703,5.61378754283411,5.69479151354794,5.80455996212757,5.42565908711133,5.50747970751996;5.57176395505208,5.58548119382418,5.47246885655447,5.53504543092170,5.48917909295792,5.47137218398418,5.49966558912050,5.67475527999633,5.52738692585705,5.66212176197142,5.49204611322213,5.62361016491638,5.37511298583911,5.62152009123231,5.54039048764690,5.61247009083095,5.63099681696398,5.42733319895182,5.68376696555441,5.67475527999633,5.62361016491638,5.62152009123231;5.52275887219930,5.59487645235038,5.69078244038576,5.50816322873170,5.59414652218209,5.51701916278071,5.37983502396611,5.55564039521708,5.68090108424857,5.48844764719097,5.37772911702196,5.59147524968829,5.55890328412172,5.78475436595783,5.58665679652077,5.38481194972937,5.65389635668323,5.43993146543036,5.52207359498261,5.55564039521708,5.59147524968829,5.78475436595783;5.56834499578329,5.59957408161348,5.62888941404184,5.47948887972903,5.82157595216778,5.57072149077662,5.79227510868354,5.52967945879083,5.48528018526966,5.45474968462163,5.59670251819411,5.57347969716056,5.14914130762278,5.70872744348293,5.72545572314241,5.61711617534323,5.61496713916050,5.46260834509172,5.45715125679847,5.52967945879083,5.57347969716056,5.70872744348293;5.55352950561849,5.64028686856033,5.52198327762961,5.60045878958404,5.60135016928571,5.52059931798044,5.41884962657452,5.43499839653040,5.67125162286396,5.50227245234762,5.48882591614607,5.59147524968829,5.54685146128352,5.46275798841708,5.67456278338114,5.71236090784491,5.71114520598136,5.30890949405362,5.52207359498261,5.43499839653040,5.59147524968829,5.46275798841708;5.50338476967611,5.56355892392972,5.60863351451110,5.57805695442571,5.72587035493399,5.59578257717472,5.44532382120165,5.57549287601362,5.50019298922769,5.76494375032402,5.58060153281381,5.50535367687700,5.51973485989756,5.47170233223765,5.46636439344869,5.75185262619927,5.70885525200943,5.60874823624269,5.76461365084032,5.57549287601362,5.50535367687700,5.47170233223765;5.59683632302327,5.40383952898437,5.50172737809887,5.46963207225936,5.66309571588816,5.56177110277731,5.51638613309553,5.45026953560466,5.57037089020668,5.66039366132683,5.72873059831262,5.52077843618648,5.42934618861103,5.56561794235371,5.53576385675951,5.63802355564848,5.62183700107628,5.31646845394074,5.77808809838797,5.45026953560466,5.52077843618648,5.56561794235371;5.55352950561849,5.68099965550719,5.49610073934033,5.56640800014337,5.58488469019172,5.51343900758098,5.57630141567272,5.49455583892002,5.56598477139549,5.56621217619714,5.51136729567850,5.67116983945396,5.34498342874360,5.69307484179692,5.55889701119645,5.62408530211165,5.72259497584099,5.50796210441443,5.19991180361605,5.49455583892002,5.67116983945396,5.69307484179692;5.49768650422811,5.50718737277254,5.43758369625153,5.74114231437839,5.58591378263510,5.54029017157894,5.68498495151042,5.52967945879083,5.44229622092003,5.48585549622410,5.58382172988987,5.77400156818386,5.46851461283519,5.54772925471255,5.57277690385861,5.55904011893976,5.74778446953216,5.63646442249546,5.33098142976138,5.52967945879083,5.77400156818386,5.54772925471255;5.53301575000570,5.49309448498324,5.65477195233112,5.59597842255238,5.49844092494829,5.48390272718322,5.72817969011258,5.38765786540018,5.42475174567529,5.63965645359186,5.55322985766729,5.61718318187077,5.39319072009641,5.54549316875741,5.60285000462663,5.68216135851511,5.51878907233965,5.73221124773231,5.66906756822970,5.38765786540018,5.61718318187077,5.54549316875741] ;
        V4LshuffleOrdCurve =  [5.62817351752401,5.56179201959384,5.69687702715226,5.52538168755079,5.55774969282078,5.43516275695911,6.02107045433167,5.71682464454976,5.61914434719100,5.80132068748531,5.68694013328943,5.71933666141005,5.59283098687652,5.46043792439813,5.57363202702832,5.81318903610802,5.70441136928017,5.53163747293840,5.72382816998733,5.69829533785171,5.48818515695378,5.70881226053640,5.69409808811305;5.40975670168091,5.60261251148076,5.62969140950792,5.49972202027114,5.73876601720204,5.50251939741713,5.57332329978365,5.77060987777501,5.66365016147622,5.63907779319338,5.56886431498995,5.49534437558384,5.61860789531543,5.61204110534152,5.61586378338948,5.62354607059776,5.52567894595321,5.64972446368825,5.73102614303812,5.47648387759293,5.30801746240732,5.50839964633068,5.60681629260183;5.44578421769626,5.36075109705072,5.55439718283755,5.58953085574991,5.62028260487976,5.62427947824510,5.28172326215784,5.44789847842355,5.66365016147622,5.49957922987695,5.65401514549439,5.42201954659140,5.44044396934064,5.57482116271470,5.57267221438375,5.53757459289977,5.49878999731111,5.75305058059437,5.48629505931130,5.50010269049086,5.31956667359619,5.34630120837017,5.41770573566085;5.38836536404679,5.61792019593836,5.56250579186359,5.52538168755079,5.52812883974022,5.55044623774304,5.30429874894178,5.62484410077326,5.49475630213742,5.51170953973056,5.40423937601472,5.62190503932421,5.50791881790131,5.44954428265369,5.58994884198605,5.32896733083848,5.52567894595321,5.49965557961031,5.41143613958310,5.40151981926474,5.29646825121844,5.20483348069555,5.71280133000831;5.58989428175769,5.62914583120727,5.60304883699379,5.60236068938973,5.57530279094260,5.58023859794562,5.87244849967078,5.52506859565977,5.68419130653094,5.65803140233963,5.46441262957118,5.55159355946845,5.57463552209612,5.56937434184248,5.52948064537802,5.44148882370790,5.57866599180678,5.58453060421177,5.55683519520903,5.55042103101253,5.64525442912249,5.75891541408783,5.45926849542810;5.54936332624042,5.60465353607511,5.60536558242980,5.49330710345123,5.47546954537476,5.51676791751402,5.89502398645471,5.59444375155899,5.52556801971950,5.59965428616917,5.54388673804199,5.54355796177064,5.68305016641269,5.48222520788700,5.68113104322036,5.77652472944270,5.61504515761669,5.42216099193072,5.62305654727629,5.69213390840008,5.61291663779364,5.39640436192160,5.70033250207814;5.60903389964085,5.67813042147158,5.59609860068576,5.32758841893684,5.69268913463226,5.48308959728501,5.32499294516038,5.40346719880269,5.56094443620263,5.38585757499943,5.56545828176978,5.48630432817381,5.51701655029151,5.56574312792767,5.58418996611861,5.50596743198139,5.58815620897458,5.42585121039166,5.50213060002304,5.62127746970630,5.70993001178020,5.69997052755674,5.37822111388196;5.53697886761014,5.62710480661292,5.55787230099157,5.55317966043707,5.49741091802703,5.61003095814821,5.06443420186248,5.49077076577700,5.41373289664380,5.43589510314554,5.49052555092588,5.50538887270609,5.49654665241355,5.52670757834344,5.52180214422145,5.49838171336098,5.48455467155940,5.56853965754773,5.57986870897156,5.52064078866297,5.61522648003141,5.61155319776009,5.54447215295096;5.39174294367323,5.60771507296663,5.66444259104810,5.71569088654151,5.33065648586976,5.51288195748760,5.60624588467689,5.56170491394363,5.46850928345639,5.55340747985231,5.70737633261050,5.53652681378507,5.56705407843762,5.69011220450997,5.50548532926373,5.66400323657328,5.54070512313557,5.61405235189923,5.47477830243004,5.72191415074964,5.55748042408704,5.52018862363690,5.52992518703242;5.76102498283064,5.63730992958465,5.73510332684645,5.56707864688021,5.65538880112340,5.65795779847411,6.18568337879786,5.58664879022200,5.49019160323637,5.68380831077854,5.56772897058323,5.63596733529536,5.70427820865649,5.52761538182214,5.54483764769117,5.84985334277334,5.54624108315012,5.39755953552450,5.56979154670045,5.55966317518998,5.67528237821357,5.70881226053640,5.46134663341646;5.57300638362549,5.56281253189101,5.74552868130850,5.57028610529017,5.49411971212919,5.55174155775184,5.62694008089550,5.50324270391619,5.47535633180796,5.52383984958416,5.44170574143667,5.54757576061955,5.60875201855938,5.58389919750173,5.65233666388321,5.65641751795287,5.46161998007054,5.53901790986027,5.62737533110676,5.55555555555555,5.64063474464694,5.62039493073976,5.66084788029925;5.62141835827113,5.47606898663129,5.41423408395885,5.54141897960057,5.65868000702124,5.56080879781350,5.12369485467031,5.35903591918184,5.61572082301521,5.30170355039007,5.48484882889225,5.57067810400072,5.44271840243819,5.51672174007771,5.52180214422145,5.51228886416507,5.55414959745662,5.64972446368825,5.75837844063112,5.54015198192647,5.50666389485598,5.28735632183908,5.44056525353283;5.49419619234190,5.52403306459843,5.31113891205634,5.55531796604371,5.55774969282078,5.61521223818344,5.35415294892296,5.51337615365428,5.49475630213742,5.59207284251067,5.59611258075137,5.71230551342447,5.45333242356010,5.63382838883039,5.51220401777573,5.28851016486295,5.52251554023061,5.65341468214918,5.53092249222619,5.52064078866297,5.71916938073130,5.66165635131152,5.25145469659185;5.85334549261999,5.51790999081539,5.43392642016495,5.73600478980456,5.57091451641215,5.59966839807775,5.86774527325746,5.64043402344724,5.51872097136793,5.63452892699828,5.57113500380341,5.58574484968410,5.74142728258315,5.61930353317114,5.68976935702151,5.50343885910792,5.52409724309191,5.44061208423539,5.52372451917540,5.54323269665229,5.38655209849167,5.56734453286177,5.68994181213633;5.65181657490909,5.51893050311256,5.55323881011954,5.57028610529017,5.50618746708794,5.63464203831557,5.84705107703885,5.64900848091793,5.67049720982780,5.68684088824194,5.65515048990111,5.57268700342517,5.75734831426600,5.57845237662951,5.56019465000432,5.56918175381815,5.67673156920741,5.54270812832120,5.41431532880341,5.69829533785171,5.75381701429792,5.62334217506631,5.64630091438072;5.41538600105831,5.52097152770691,5.46520248355111,5.61519052302955,5.56542917324908,5.57894327793682,5.20929357539272,5.54923297580444,5.53127389334581,5.40936005034079,5.59384189193792,5.56264250630292,5.41163448343834,5.60387087403319,5.52660120744431,5.48826742186710,5.56996662606963,5.57838024011022,5.48197627548083,5.44362292051756,5.73071859192017,5.47303271441202,5.63591022443890;5.51558752997602,5.57812021634861,5.35747382077657,5.45481760253176,5.46449885904862,5.55174155775184,5.19612454143543,5.53909952606635,5.56779148455420,5.45105799046255,5.46554797397791,5.48831322759826,5.36235509965808,5.47587058353608,5.31448261299394,5.42126024072014,5.54149597456622,5.63373351702421,5.48197627548083,5.26596837132881,5.54362137066038,5.65870910698497,5.57148794679967;5.56512536449713,5.37401775691397,5.51385413770735,5.55745627165035,5.51057574161840,5.43386743695030,5.64575298654877,5.52428909952607,5.54154446587317,5.63225449390073,5.53821001600836,5.44210854083590,5.52004912775491,5.52943098877955,5.50356570397459,5.52113886922221,5.54149597456622,5.51564652627436,5.52228492456525,5.69008009858287,5.49049499919156,5.64397288535220,5.59850374064838]  ;
        V4RshuffleOrdCurve =    [5.65905634989224,5.73441977625259,5.63964502941470,5.72844860971265,5.52786543584904,5.56868827492128,5.66886546869866,5.64335035029142,5.57656069539846,5.59488827972469,5.49845072101061,5.59758904388296,5.55504713096001,5.35312851255152,5.62576949169577;5.51902943847021,5.46518861478528,5.57782430950244,5.45503833940051,5.67925993649296,5.44909228512432,5.55639800844138,5.60466270258450,5.43675156525439,5.47951959295561,5.62060541055893,5.62556427308910,5.61682071931912,5.67159985013114,5.62828211764114;5.51902943847021,5.47640657984642,5.36045468142387,5.35125087135001,5.55932403338544,5.58550646098648,5.49447772133344,5.44823004011741,5.36988632909854,5.59587433687656,5.61017757120724,5.72347757531059,5.45895488240139,5.57559010865493,5.64335787331340;5.48292875036921,5.54881344524103,5.57283876757403,5.66183874215785,5.64780133895656,5.57803171162417,5.57029848105745,5.59288820110849,5.52428423804024,5.59390222257282,5.68317244666905,5.68660113681159,5.40404502608218,5.51704758336456,5.64335787331340;5.58138517246283,5.50088213997981,5.73736165121149,5.60529780807064,5.57701949449966,5.71724891849720,5.77627821164101,5.69213042783492,5.64828885782019,5.57911136529473,5.38374448814206,5.55562620007375,5.56419877367987,5.72780067440989,5.43229729390186;5.65468050891031,5.67017143090243,5.60275201914448,5.55030594067075,5.62715663432330,5.53038018443944,5.57661687770112,5.60298063094507,5.62883715275667,5.54854359358668,5.54910022643308,5.59377423990031,5.45666697172142,5.56153990258524,5.71119877383854;5.46323746595049,5.41623749451849,5.52796889021837,5.61071954147626,5.46986364664130,5.52944584076915,5.67518386534233,5.43056828790338,5.70421250987782,5.47656142149999,5.62060541055893,5.69423074477690,5.51386473872060,5.78868490071188,5.52526445388075;5.57482141098992,5.56513048532996,5.35247781433842,5.59290527457207,5.47084672781432,5.48272865725471,5.56524376374251,5.39692685511476,5.65558324721901,5.43613307827322,5.64444047193422,5.45516969519716,5.56877459503981,5.62710753091045,5.42475941606573;5.55184824583475,5.53555585016878,5.61372021138698,5.69049647587329,5.58685030622979,5.57896605529446,5.58293527434478,5.48355354454546,5.63856300528843,5.61855365136963,5.63550232391848,5.46534250581758,5.68774595039810,5.43742974896965,5.66345888087640;5.59998249663607,5.59164567547447,5.60275201914448,5.58980714119743,5.76675416089107,5.66959739131247,5.44519422751283,5.55756469668043,5.63248434745608,5.68264736624135,5.70849719938029,5.56325580803906,5.52530429212043,5.34610340951667,5.67853463654866;5.63936506547352,5.59980419551893,5.43124937680726,5.57896367438618,5.39711563983838,5.56027918188868,5.49068668334723,5.51635394151437,5.56805057443317,5.59390222257282,5.63252294124657,5.68024313017383,5.50471309600073,5.63647433495691,5.42475941606573;5.50918379626084,5.57634845039110,5.55987635856017,5.50615754008210,5.43447272441286,5.43694581741056,5.34409988121414,5.40197307003305,5.49024375417908,5.40556530656517,5.63252294124657,5.39158962881957,5.59851743387938,5.50299737729487,5.42475941606573;5.54966032534378,5.53045677514099,5.54093129923223,5.38223220509643,5.41186185743357,5.51823371672569,5.43382111355422,5.64082724283227,5.33098291897149,5.56432050801664,5.52973423906567,5.47297211378289,5.86391507275556,5.48894717122518,5.51521395009925;5.57263349049895,5.50700103001316,5.73137900089740,5.48679420649059,5.63600436488041,5.62568323880890,5.55639800844138,5.57438541307474,5.44526168621968,5.43909124972883,5.43737337623644,5.42846606731857,5.66029102223849,5.50065567628325,5.46747405713711;5.57810329172638,5.50292176999092,5.62867683717220,5.65641700875223,5.48559294540950,5.59111252300821,5.49700507999090,5.66774038906317,5.64221019998784,5.49233833592995,5.56697652246454,5.47933012042065,5.65342729019859,5.83317721993256,5.39209527877585;5.47089518766888,5.57736826539666,5.50104696380496,5.62930834172411,5.64288593309150,5.55841049454811,5.55134329112644,5.58868302200991,5.57412923226552,5.62841422288836,5.43588368490049,5.46407090449003,5.31939233092340,5.49363057324841,5.46998668308249;5.38009648729365,5.61408160559675,5.48010768770565,5.45658740608783,5.50525456886975,5.43227409905912,5.56145272575631,5.61307306078166,5.72731140964075,5.64912142307768,5.35097127875104,5.55562620007375,5.57563832707971,5.69970026227051,5.56546646900676;5.69406307774775,5.58756641545224,5.53893708246086,5.46743087289908,5.57407025098063,5.58737514832706,5.65370131675386,5.54410812356498,5.40635827609264,5.62151182282525,5.45971874627577,5.56707061202172,5.47268234648119,5.23838516298239,5.76396391869142] ;

        if sum(inN==[1:4])>0

            temppara = load([Resultfolder,tempname,'_parameters_3peak_fitnlm_shuffle.mat']);
            shufflepara = temppara.para;    
            temppara = load([Resultfolder,tempname,'_parameters_2peak_fitnlm_shuffle.mat']);
            shufflepara2p = temppara.para2p;    
            temppara = load([Resultfolder,tempname,'_parameters_1peak_fitnlm_shuffle.mat']);
            shufflepara1p = temppara.para1p;
            tempUyy = load([Resultfolder,tempname,'_yyCombined_yyCardinal_yyRadial_fitnlm_shuffle.mat']);
            shuffleUyy = tempUyy.Uyy;
            temppara = load([Resultfolder,tempname,'_statc_lratiotest_shuffle.mat']);
            LRT = temppara.Usta;

            if inNN == 1
                V1Lshufflepara = shufflepara;
                V1Lshufflepara2p = shufflepara2p;
                V1Lshufflepara1p = shufflepara1p;
                V1LshuffleUyy = shuffleUyy;
                V1LshuffleLRT = LRT;
            elseif inNN == 2
                V1Rshufflepara = shufflepara;
                V1Rshufflepara2p = shufflepara2p;
                V1Rshufflepara1p = shufflepara1p;
                V1RshuffleUyy = shuffleUyy;
                V1RshuffleLRT = LRT;
            elseif inNN ==3
                V4Lshufflepara = shufflepara;
                V4Lshufflepara2p = shufflepara2p;
                V4Lshufflepara1p = shufflepara1p;
                V4LshuffleUyy = shuffleUyy;
                V4LshuffleLRT = LRT;
            elseif inNN ==4
                V4Rshufflepara = shufflepara;
                V4Rshufflepara2p = shufflepara2p;
                V4Rshufflepara1p = shufflepara1p;
                V4RshuffleUyy = shuffleUyy;    
                V4RshuffleLRT = LRT;
            end
        end        
    end    
    %%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% R&L-flip
    if inNN ==6
        for curveflip = 1

            tempV = flipud(V1LOrdCurve);
            V1OrdCurve = [[tempV(end,:);tempV(1:end-1,:)],V1ROrdCurve];
            tempUyy = flipud(V1LUyy(:,:,1));
            V1Uyy = [[tempUyy(end,:);tempUyy(1:end-1,:)],V1RUyy(:,:,1)];
            tempUyy = flipud(V1LUyy(:,:,2));
            V1UyyCard = [[tempUyy(end,:);tempUyy(1:end-1,:)],V1RUyy(:,:,2)];
            tempUyy = flipud(V1LUyy(:,:,3));
            V1UyyRad = [[tempUyy(end,:);tempUyy(1:end-1,:)],V1RUyy(:,:,3)];
            tempmean = mean(V1Uyy');
            tempstd = std(V1Uyy')/sqrt(size(V1Uyy,2));
            V1Uyyup = tempmean+1.96*tempstd;
            V1Uyydown = tempmean-1.96*tempstd;
            tempmean = mean(V1RUyy(:,:,1)');
            tempstd = std(V1RUyy(:,:,1)')/sqrt(size(V1RUyy(:,:,1),2));
            V1RUyyup = tempmean+1.96*tempstd;
            V1RUyydown = tempmean-1.96*tempstd;    
            tempmean = mean(V1LUyy(:,:,1)');
            tempstd = std(V1LUyy(:,:,1)')/sqrt(size(V1LUyy(:,:,1),2));
            V1LUyyup = tempmean+1.96*tempstd;
            V1LUyydown = tempmean-1.96*tempstd;    

            tempV = flipud(V4LwholeOrdCurve);
            V4wholeOrdCurve = [[tempV(end,:);tempV(1:end-1,:)],V4RwholeOrdCurve];
            tempUyy = flipud(V4LwholeUyy(:,:,1));
            V4wholeUyy = [[tempUyy(end,:);tempUyy(1:end-1,:)],V4RwholeUyy(:,:,1)];
            tempUyy = flipud(V4LwholeUyy(:,:,2));
            V4wholeUyyCard = [[tempUyy(end,:);tempUyy(1:end-1,:)],V4RwholeUyy(:,:,2)];
            tempUyy = flipud(V4LwholeUyy(:,:,3));
            V4wholeUyyRad = [[tempUyy(end,:);tempUyy(1:end-1,:)],V4RwholeUyy(:,:,3)];
            tempmean = mean(V4wholeUyy');
            tempstd = std(V4wholeUyy')/sqrt(size(V4wholeUyy,2));
            V4wholeUyyup = tempmean+1.96*tempstd;
            V4wholeUyydown = tempmean-1.96*tempstd;

            tempV = flipud(V2LwholeOrdCurve);
            V2wholeOrdCurve = [[tempV(end,:);tempV(1:end-1,:)],V2RwholeOrdCurve];
            tempUyy = flipud(V2LwholeUyy(:,:,1));
            V2wholeUyy = [[tempUyy(end,:);tempUyy(1:end-1,:)],V2RwholeUyy(:,:,1)];
            tempUyy = flipud(V2LwholeUyy(:,:,2));
            V2wholeUyyCard = [[tempUyy(end,:);tempUyy(1:end-1,:)],V2RwholeUyy(:,:,2)];
            tempUyy = flipud(V2LwholeUyy(:,:,3));
            V2wholeUyyRad = [[tempUyy(end,:);tempUyy(1:end-1,:)],V2RwholeUyy(:,:,3)];
            tempmean = mean(V2wholeUyy');
            tempstd = std(V2wholeUyy')/sqrt(size(V2wholeUyy,2));
            V2wholeUyyup = tempmean+1.96*tempstd;
            V2wholeUyydown = tempmean-1.96*tempstd;

            %%%%%%%%%%% shuffle data
            tempV = flipud(V1LshuffleOrdCurve);
            V1shuffleOrdCurve = [[tempV(end,:);tempV(1:end-1,:)],V1RshuffleOrdCurve];
            tempV = flipud(V4LshuffleOrdCurve);
            V4shuffleOrdCurve = [[tempV(end,:);tempV(1:end-1,:)],V4RshuffleOrdCurve];
            V1shuffleLRT = [V1LshuffleLRT;V1RshuffleLRT];
            V4shuffleLRT = [V4LshuffleLRT;V4RshuffleLRT];

            tempUyy = flipud(V1LshuffleUyy(:,:,1));
            V1shuffleUyy = [[tempUyy(end,:);tempUyy(1:end-1,:)],V1RshuffleUyy(:,:,1)];
            tempUyy = flipud(V1LshuffleUyy(:,:,2));
            V1shuffleUyyCard = [[tempUyy(end,:);tempUyy(1:end-1,:)],V1RshuffleUyy(:,:,2)];
            tempUyy = flipud(V1LshuffleUyy(:,:,3));
            V1shuffleUyyRad = [[tempUyy(end,:);tempUyy(1:end-1,:)],V1RshuffleUyy(:,:,3)];

            tempUyy = flipud(V4LshuffleUyy(:,:,1));
            V4shuffleUyy = [[tempUyy(end,:);tempUyy(1:end-1,:)],V4RshuffleUyy(:,:,1)];
            tempUyy = flipud(V4LshuffleUyy(:,:,2));
            V4shuffleUyyCard = [[tempUyy(end,:);tempUyy(1:end-1,:)],V4RshuffleUyy(:,:,2)];
            tempUyy = flipud(V4LshuffleUyy(:,:,3));
            V4shuffleUyyRad = [[tempUyy(end,:);tempUyy(1:end-1,:)],V4RshuffleUyy(:,:,3)];

            shuffleUyy = [V1shuffleUyy,V4shuffleUyy];
            tempmean = mean(shuffleUyy');
            tempstd = std(shuffleUyy')/sqrt(size(shuffleUyy,2));
            shuffleUyyup = tempmean+1.96*tempstd;
            shuffleUyydown = tempmean-1.96*tempstd;      

            %%%%%%%%%%% para combined
            V1para = [V1Lpara;V1Rpara];
            V1para2p = [V1Lpara2p;V1Rpara2p];
            V1para1p = [V1Lpara1p;V1Rpara1p];
            V1LRT = [V1LLRT;V1RLRT];

            V2wholepara = [V2Lwholepara;V2Rwholepara];
            V2wholepara2p = [V2Lwholepara2p;V2Rwholepara2p];
            V2wholepara1p = [V2Lwholepara1p;V2Rwholepara1p];
            V2wholeLRT = [V2LwholeLRT;V2RwholeLRT];

            V4wholepara = [V4Lwholepara;V4Rwholepara];
            V4wholepara2p = [V4Lwholepara2p;V4Rwholepara2p];
            V4wholepara1p = [V4Lwholepara1p;V4Rwholepara1p];
            V4wholeLRT = [V4LwholeLRT;V4RwholeLRT];

            V1shufflepara = [V1Lshufflepara;V1Rshufflepara];
            V1shufflepara2p = [V1Lshufflepara2p;V1Rshufflepara2p];
            V1shufflepara1p = [V1Lshufflepara1p;V1Rshufflepara1p];

            V4shufflepara = [V4Lshufflepara;V4Rshufflepara];
            V4shufflepara2p = [V4Lshufflepara2p;V4Rshufflepara2p];
            V4shufflepara1p = [V4Lshufflepara1p;V4Rshufflepara1p];

            end
    end
    %%%%%%%%%%%%%%%
    
end


%% V1 Fig3 ABC   
for V1fig3ABCplot = 1
    %% V1 R&L-hemi Fig3A  
    %%%%%%%%%%
    V1Lbin18 = V1LOrdCurve';
    V1Rbin18 = V1ROrdCurve';
    %%%%%%%%%%%%%% up down 95%CI cal %%%%%%%%%%%
    data = V1RUyy(:,:,1);
    yyc = mean(data,2)';
    yyup=[];yydown=[];
    for i = 1:size(yyc,2)
        yyup(1,i) = yyc(i) + std(data(i,:))/sqrt(size(data,2))*1.96;
        yydown(1,i) = yyc(i) - std(data(i,:))/sqrt(size(data,2))*1.96;
    end
    %%%%%%%%%%%%%% plotR %%%%%%%%%%%
    for allV1 = 1
        
        tempdata = V1Rbin18;
        meandata = mean(tempdata,1); 
        stddata = std(tempdata,1)/sqrt(size(tempdata,1))*1.96;
        fig = figure('color',[1 1 1]);
        set(fig,'units','normalized','position',[0.1 0.1 0.4 0.624]);
        hold on;
        plottype = [{'o'}];
        g = plot(ones(size(tempdata,2)+1,1)*(100/size(tempdata,2)),'--');hold on;
        set(g,'color',[0.5 0.5 0.5],'LineWidth',2);
        g = plot([10 10],[0 100],'--');hold on;
        set(g,'color',[0.5 0.5 0.5],'LineWidth',2);
        h(1) = errorbar([1:1:19]-0.075,[meandata,meandata(1)],[stddata,stddata(1)],plottype{1});hold on;
        set(h(1),'color',Rcolor,'LineWidth',2.5,'Markersize',3,'MarkerFaceColor',Rcolor);
        h(2) = fill([20:1:360+20,fliplr(20:1:360+20)]/20,[yydown,yydown(1),fliplr([yyup,yyup(1)])],'-');hold on;
        set(h(2),'facecolor',Rcolor,'edgecolor','none');
        h(1) = plot([20:1:360+20]/20,[yyc,yyc(1)],'-');hold on;
        set(h(1),'color',Bcolor,'LineWidth',3.5);
        set(gca,'box','off');
        xlim([0.5,19.6]);
        ylim([4.6,7.1]);
        set(gca,'XTick',[1:4.5:50],'Xticklabel',{'0','45','90','135','180'},'fontsize',27);
        set(gca,'YTick',[0:0.5:10],'fontsize',27);
        set(gca,'Yticklabel',num2str(get(gca,'YTick')','%.1f'))
        xlabel('Orientation(¡ã)','fontsize',30);
        set(gca,'linewidth',1.5);

    end   
    %%%%%%%%%%%%%% up down 95%CI cal %%%%%%%%%%%
    data = V1LUyy(:,:,1);
    yyc = mean(data,2)';
    yyup=[];yydown=[];
    for i = 1:size(yyc,2)
        yyup(1,i) = yyc(i) + std(data(i,:))/sqrt(size(data,2))*1.96;
        yydown(1,i) = yyc(i) - std(data(i,:))/sqrt(size(data,2))*1.96;
    end
    %%%%%%%%%%%%%% plotL %%%%%%%%%%%
    for allV1 = 1
        tempdata = V1Lbin18;
        meandata = mean(tempdata,1); 
        stddata = std(tempdata,1)/sqrt(size(tempdata,1))*1.96;
        hold on;
        plottype = [{'o'}];
        h(1) = errorbar([1:1:19]+0.075,[meandata,meandata(1)],[stddata,stddata(1)],plottype{1});hold on;
        set(h(1),'color',Lcolor,'LineWidth',2.5,'Markersize',3,'MarkerFaceColor',Lcolor);
        h(2) = fill([20:1:360+20,fliplr(20:1:360+20)]/20,[yydown,yydown(1),fliplr([yyup,yyup(1)])],'-');hold on;
        set(h(2),'facecolor',Lcolor,'edgecolor','none');
        h(1) = plot([20:1:360+20]/20,[yyc,yyc(1)],'-');hold on;
        set(h(1),'color',Bcolor,'LineWidth',3.5);
        set(gca,'box','off');
        xlim([0.5,19.6]);
        ylim([3.5,8.227]);
        set(gca,'XTick',[1:4.5:50],'Xticklabel',{'0','45','90','135','180'},'fontsize',27);
        set(gca,'YTick',[0:1:10],'fontsize',27);
        set(gca,'Yticklabel',num2str(get(gca,'YTick')','%.1f'))
        xlabel('Orientation(¡ã)','fontsize',30);
        set(gca,'linewidth',1.5);
        saveas(fig,[pwd,'\Figure_Results\Fig3A_V1_R&L_46cases.tiff']);
        saveas(fig,[pwd,'\Figure_Results\Fig3A_V1_R&L_46cases.pdf']);
        close all;
        
    end    

    %% V1 2 components  Fig3C  
    %%%%%%%%%%%%%% R&flipL %%%%%%%%%%%
    tempflip = fliplr(V1Lbin18);
    V1bin18 = [[V1Lbin18(:,18),tempflip(:,1:end-1)];V1Rbin18];
    %%%%%%%%%%%%%% up down 95%CI cal %%%%%%%%%%%
    data = V1UyyCard;
    yyc = mean(data,2)';
    yyup=[];yydown=[];
    for i = 1:size(yyc,2)
        yyup(1,i) = yyc(i) + std(data(i,:))/sqrt(size(data,2))*1.96;
        yydown(1,i) = yyc(i) - std(data(i,:))/sqrt(size(data,2))*1.96;
    end
    %%%%%%%%%%%%%% up down card plot %%%%%%%%%%%
    for allV1component = 1
        
        tempdata = V1bin18;
        meandata = mean(tempdata,1); 
        stddata = std(tempdata,1);
        fig = figure('color',[1 1 1]);
        set(fig,'units','normalized','position',[0.1 0.1 0.4 0.55]);
        hold on;
        g = plot([10 10],[0 100],'--');hold on;
        set(g,'color',[0.5 0.5 0.5],'LineWidth',2);
        h(2) = fill([20:1:360+20,fliplr(20:1:360+20)]/20,[yydown,yydown(1),fliplr([yyup,yyup(1)])],'-');hold on;
        set(h(2),'facecolor',modelacolor,'edgecolor','none');
        h(1) = plot([20:1:360+20]/20,[yyc,yyc(1)],'-');hold on;
        set(h(1),'color',Bcolor,'LineWidth',3.5);
        set(gca,'box','off');
        xlim([0.5,19.6]);
        ylim([3.5,7.5]-3.5);
        set(gca,'XTick',[1:4.5:50],'Xticklabel',{'0','45','90','135','180'},'fontsize',27);
        set(gca,'YTick',[0:1:10],'fontsize',27);
        set(gca,'Yticklabel',num2str(get(gca,'YTick')','%.1f'))
        xlabel('Orientation(¡ã)','fontsize',30);
        set(gca,'linewidth',1.5);

    end   
    %%%%%%%%%%%%%% up down 95%CI cal %%%%%%%%%%%
    data = V1UyyRad;
    yyc = mean(data,2)';
    yyup=[];yydown=[];
    for i = 1:size(yyc,2)
        yyup(1,i) = yyc(i) + std(data(i,:))/sqrt(size(data,2))*1.96;
        yydown(1,i) = yyc(i) - std(data(i,:))/sqrt(size(data,2))*1.96;
    end
    %%%%%%%%%%%%%% up down card plot %%%%%%%%%%%
    for allV1component = 1
        
        tempdata = V1bin18;
        meandata = mean(tempdata,1); 
        stddata = std(tempdata,1);
        hold on;
        h(2) = fill([20:1:360+20,fliplr(20:1:360+20)]/20,[yydown,yydown(1),fliplr([yyup,yyup(1)])],'-');hold on;
        set(h(2),'facecolor',modelbcolor,'edgecolor','none');
        h(1) = plot([20:1:360+20]/20,[yyc,yyc(1)],'-');hold on;
        set(h(1),'color',Bcolor,'LineWidth',3.5);
        set(gca,'box','off');
        xlim([0.5,19.6]);
        ylim([3.5,7.5]-3.5);
        set(gca,'XTick',[1:4.5:50],'Xticklabel',{'0','45','90','135','180'},'fontsize',27);
        set(gca,'YTick',[0:1:10],'fontsize',27);
        set(gca,'Yticklabel',num2str(get(gca,'YTick')','%.1f'))
        xlabel('Orientation(¡ã)','fontsize',30);
        set(gca,'linewidth',1.5);
        saveas(fig,[pwd,'\Figure_Results\Fig3C_V1_R&L_46cases_components.tiff']);
        saveas(fig,[pwd,'\Figure_Results\Fig3C_V1_R&L_46cases_components.pdf']);
        close all;

    end   

    %% V1 R&flipL  Fig3B
    %%%%%%%%%%%%%% up down rad cal %%%%%%%%%%%
    data = V1Uyy;
    yyc = mean(data,2)';
    yyup=[];yydown=[];
    for i = 1:size(yyc,2)
        yyup(1,i) = yyc(i) + std(data(i,:))/sqrt(size(data,2))*1.96;
        yydown(1,i) = yyc(i) - std(data(i,:))/sqrt(size(data,2))*1.96;
    end
    %%%%%%%%%%%%%% R&flipL plot %%%%%%%%%%%
    for allV1 = 1
        
        tempdata = V1bin18;
        meandata = mean(tempdata,1);
        stddata = std(tempdata,1)/sqrt(size(tempdata,1))*1.96;
        fig = figure('color',[1 1 1]);
        set(fig,'units','normalized','position',[0.1 0.1 0.4 0.55]);
        hold on;
        plottype = [{'o'}];
        g = plot(ones(size(tempdata,2)+1,1)*(100/size(tempdata,2)),'--');hold on;
        set(g,'color',[0.5 0.5 0.5],'LineWidth',2);
        g = plot([10 10],[0 100],'--');hold on;
        set(g,'color',[0.5 0.5 0.5],'LineWidth',2);
        h(1) = errorbar([meandata,meandata(1)],[stddata,stddata(1)],plottype{1});hold on;
        set(h(1),'color',[0 0 0],'LineWidth',2.5,'Markersize',3,'MarkerFaceColor',[0 0 0]);
        h(2) = fill([20:1:360+20,fliplr(20:1:360+20)]/20,[yydown,yydown(1),fliplr([yyup,yyup(1)])],'-');hold on;
        set(h(2),'facecolor',Bcolor,'edgecolor','none');
        h(1) = plot([20:1:360+20]/20,[yyc,yyc(1)],'-');hold on;
        set(h(1),'color',Bcolor,'LineWidth',3.5);
        set(gca,'box','off');
        xlim([0.5,19.6]);
        ylim([4.7,6.35]);
        set(gca,'XTick',[1:4.5:50],'Xticklabel',{'0','45','90','135','180'},'fontsize',27);
        set(gca,'YTick',[0:0.5:10],'fontsize',27);
        set(gca,'Yticklabel',num2str(get(gca,'YTick')','%.1f'))
        xlabel('Orientation(¡ã)','fontsize',30);
        set(gca,'linewidth',1.5);

    end
    %%%%%%%%%%%%%% R&flipL %%%%%%%%%%%
    tempflip = fliplr(V1LshuffleOrdCurve');
    V1bin18 = [[V1LshuffleOrdCurve(18,:)',tempflip(:,1:end-1)];V1RshuffleOrdCurve'];
    %%%%%%%%%%%%%% up down rad cal %%%%%%%%%%%
    data = V1shuffleUyy;
    yyc = mean(data,2)';
    yyup=[];yydown=[];
    for i = 1:size(yyc,2)
        yyup(1,i) = yyc(i) + std(data(i,:))/sqrt(size(data,2))*1.96;
        yydown(1,i) = yyc(i) - std(data(i,:))/sqrt(size(data,2))*1.96;
    end
    for allV1 = 1
        
        tempdata = V1bin18;
        meandata = mean(tempdata,1);
        stddata = std(tempdata,1)/sqrt(size(tempdata,1))*1.96;
        h(1) = errorbar([meandata,meandata(1)],[stddata,stddata(1)],plottype{1});hold on;
        set(h(1),'color',[0.5 0.5 0.5],'LineWidth',2.5,'Markersize',3,'MarkerFaceColor','none');
        h(2) = fill([20:1:360+20,fliplr(20:1:360+20)]/20,[yydown,yydown(1),fliplr([yyup,yyup(1)])],'-');hold on;
        set(h(2),'facecolor',Bcolor,'edgecolor','none');
        h(1) = plot([20:1:360+20]/20,[yyc,yyc(1)],'-');hold on;
        set(h(1),'color',Bcolor,'LineWidth',3.5);
        set(gca,'box','off');
        xlim([0.5,19.6]);
        ylim([3.5,7.5]);
        set(gca,'XTick',[1:4.5:50],'Xticklabel',{'0','45','90','135','180'},'fontsize',27);
        set(gca,'YTick',[0:1:10],'fontsize',27);
        set(gca,'Yticklabel',num2str(get(gca,'YTick')','%.1f'))
        xlabel('Orientation(¡ã)','fontsize',30);
        set(gca,'linewidth',1.5);
        saveas(fig,[pwd,'\Figure_Results\Fig3B_V1_R&L_46cases_data_shuffle.tiff']);
        saveas(fig,[pwd,'\Figure_Results\Fig3B_V1_R&L_46cases_data_shuffle.pdf']);
        close all;

    end   

end

%% V4 Fig3 DEF
for V4fig3DEFplot = 1

    %% V1 R&L-hemi Fig3D  
    %%%%%%%%%%
    V4Lwholebin18 = V4LwholeOrdCurve';
    V4Rwholebin18 = V4RwholeOrdCurve';
    %%%%%%%%%%%%%% up down 95%CI cal %%%%%%%%%%%
    data = V4RwholeUyy(:,:,1);
    yyc = mean(data,2)';
    yyup=[];yydown=[];
    for i = 1:size(yyc,2)
        yyup(1,i) = yyc(i) + std(data(i,:))/sqrt(size(data,2))*1.96;
        yydown(1,i) = yyc(i) - std(data(i,:))/sqrt(size(data,2))*1.96;
    end
    %%%%%%%%%%%%%% plotR %%%%%%%%%%%
    for allV4 = 1
        
        tempdata = V4Rwholebin18;
        meandata = mean(tempdata,1); 
        stddata = std(tempdata,1)/sqrt(size(tempdata,1))*1.96;
        fig = figure('color',[1 1 1]);
        set(fig,'units','normalized','position',[0.1 0.1 0.4 0.624]);
        hold on;
        plottype = [{'o'}];
        g = plot(ones(size(tempdata,2)+1,1)*(100/size(tempdata,2)),'--');hold on;
        set(g,'color',[0.5 0.5 0.5],'LineWidth',2);
        g = plot([10 10],[0 100],'--');hold on;
        set(g,'color',[0.5 0.5 0.5],'LineWidth',2);
        h(1) = errorbar([1:1:19]-0.075,[meandata,meandata(1)],[stddata,stddata(1)],plottype{1});hold on;
        set(h(1),'color',Rcolor,'LineWidth',2.5,'Markersize',3,'MarkerFaceColor',Rcolor);
        h(2) = fill([20:1:360+20,fliplr(20:1:360+20)]/20,[yydown,yydown(1),fliplr([yyup,yyup(1)])],'-');hold on;
        set(h(2),'facecolor',Rcolor,'edgecolor','none');
        h(1) = plot([20:1:360+20]/20,[yyc,yyc(1)],'-');hold on;
        set(h(1),'color',Bcolor,'LineWidth',3.5);
        set(gca,'box','off');
        xlim([0.5,19.6]);
        ylim([4.6,7.1]);
        set(gca,'XTick',[1:4.5:50],'Xticklabel',{'0','45','90','135','180'},'fontsize',27);
        set(gca,'YTick',[0:0.5:10],'fontsize',27);
        set(gca,'Yticklabel',num2str(get(gca,'YTick')','%.1f'))
        xlabel('Orientation(¡ã)','fontsize',30);
        set(gca,'linewidth',1.5);

    end   
    %%%%%%%%%%%%%% up down Lcal %%%%%%%%%%%
    data = V4LwholeUyy(:,:,1);
    yyc = mean(data,2)';
    yyup=[];yydown=[];
    for i = 1:size(yyc,2)
        yyup(1,i) = yyc(i) + std(data(i,:))/sqrt(size(data,2))*1.96;
        yydown(1,i) = yyc(i) - std(data(i,:))/sqrt(size(data,2))*1.96;
    end
    %%%%%%%%%%%%%% plotL %%%%%%%%%%%
    for allV4 = 1
        
        tempdata = V4Lwholebin18;
        meandata = mean(tempdata,1); 
        stddata = std(tempdata,1)/sqrt(size(tempdata,1))*1.96;
        hold on;
        plottype = [{'o'}];
        h(1) = errorbar([1:1:19]+0.075,[meandata,meandata(1)],[stddata,stddata(1)],plottype{1});hold on;
        set(h(1),'color',Lcolor,'LineWidth',2.5,'Markersize',3,'MarkerFaceColor',Lcolor);
        h(2) = fill([20:1:360+20,fliplr(20:1:360+20)]/20,[yydown,yydown(1),fliplr([yyup,yyup(1)])],'-');hold on;
        set(h(2),'facecolor',Lcolor,'edgecolor','none');
        h(1) = plot([20:1:360+20]/20,[yyc,yyc(1)],'-');hold on;
        set(h(1),'color',Bcolor,'LineWidth',3.5);
        set(gca,'box','off');
        xlim([0.5,19.6]);
        ylim([3.5,8.227]);
        set(gca,'XTick',[1:4.5:50],'Xticklabel',{'0','45','90','135','180'},'fontsize',27);
        set(gca,'YTick',[0:1:10],'fontsize',27);
        set(gca,'Yticklabel',num2str(get(gca,'YTick')','%.1f'))
        xlabel('Orientation(¡ã)','fontsize',30);
        set(gca,'linewidth',1.5);
        saveas(fig,[pwd,'\Figure_Results\Fig3D_V4_R&L_38cases.tiff']);
        saveas(fig,[pwd,'\Figure_Results\Fig3D_V4_R&L_38cases.pdf']);
        close all;
        
    end    

    %% V4 2 components  Fig3E  
    %%%%%%%%%%%%%% R&flipL %%%%%%%%%%%
    tempflip = fliplr(V4Lwholebin18);
    V4bin18 = [[V4Lwholebin18(:,18),tempflip(:,1:end-1)];V4Rwholebin18];
    %%%%%%%%%%%%%% up down card cal %%%%%%%%%%%
    data = V4wholeUyyCard;
    yyc = mean(data,2)';
    yyup=[];yydown=[];
    for i = 1:size(yyc,2)
        yyup(1,i) = yyc(i) + std(data(i,:))/sqrt(size(data,2))*1.96;
        yydown(1,i) = yyc(i) - std(data(i,:))/sqrt(size(data,2))*1.96;
    end
    %%%%%%%%%%%%%% up down card plot %%%%%%%%%%%
    for allV4component = 1
        
        tempdata = V4bin18;
        meandata = mean(tempdata,1); 
        stddata = std(tempdata,1);
        fig = figure('color',[1 1 1]);
        set(fig,'units','normalized','position',[0.1 0.1 0.4 0.55]);
        hold on;
        g = plot([10 10],[0 100],'--');hold on;
        set(g,'color',[0.5 0.5 0.5],'LineWidth',2);
        h(2) = fill([20:1:360+20,fliplr(20:1:360+20)]/20,[yydown,yydown(1),fliplr([yyup,yyup(1)])],'-');hold on;
        set(h(2),'facecolor',modelacolor,'edgecolor','none');
        h(1) = plot([20:1:360+20]/20,[yyc,yyc(1)],'-');hold on;
        set(h(1),'color',Bcolor,'LineWidth',3.5);
        set(gca,'box','off');
        xlim([0.5,19.6]);
        ylim([3.5,7.5]-3.5);
        set(gca,'XTick',[1:4.5:50],'Xticklabel',{'0','45','90','135','180'},'fontsize',27);
        set(gca,'YTick',[0:1:10],'fontsize',27);
        set(gca,'Yticklabel',num2str(get(gca,'YTick')','%.1f'))
        xlabel('Orientation(¡ã)','fontsize',30);
        set(gca,'linewidth',1.5);

    end   
    %%%%%%%%%%%%%% up down rad cal %%%%%%%%%%%
    data = V4wholeUyyRad;
    yyc = mean(data,2)';
    yyup=[];yydown=[];
    for i = 1:size(yyc,2)
        yyup(1,i) = yyc(i) + std(data(i,:))/sqrt(size(data,2))*1.96;
        yydown(1,i) = yyc(i) - std(data(i,:))/sqrt(size(data,2))*1.96;
    end
    %%%%%%%%%%%%%% up down card plot %%%%%%%%%%%
    for allV4component = 1
        
        tempdata = V4bin18;
        meandata = mean(tempdata,1); 
        stddata = std(tempdata,1);
        hold on;
        h(2) = fill([20:1:360+20,fliplr(20:1:360+20)]/20,[yydown,yydown(1),fliplr([yyup,yyup(1)])],'-');hold on;
        set(h(2),'facecolor',modelbcolor,'edgecolor','none');
        h(1) = plot([20:1:360+20]/20,[yyc,yyc(1)],'-');hold on;
        set(h(1),'color',Bcolor,'LineWidth',3.5);
        set(gca,'box','off');
        xlim([0.5,19.6]);
        ylim([3.5,7.5]-3.5);
        set(gca,'XTick',[1:4.5:50],'Xticklabel',{'0','45','90','135','180'},'fontsize',27);
        set(gca,'YTick',[0:1:10],'fontsize',27);
        set(gca,'Yticklabel',num2str(get(gca,'YTick')','%.1f'))
        xlabel('Orientation(¡ã)','fontsize',30);
        set(gca,'linewidth',1.5);
        saveas(fig,[pwd,'\Figure_Results\Fig3F_V4_R&L_38cases_components.tiff']);
        saveas(fig,[pwd,'\Figure_Results\Fig3F_V4_R&L_38cases_components.pdf']);
        close all;

    end   

    %% V4 R&flipL
    %%%%%%%%%%%%%% up down rad cal %%%%%%%%%%%
    data = V4wholeUyy;
    yyc = mean(data,2)';
    yyup=[];yydown=[];
    for i = 1:size(yyc,2)
        yyup(1,i) = yyc(i) + std(data(i,:))/sqrt(size(data,2))*1.96;
        yydown(1,i) = yyc(i) - std(data(i,:))/sqrt(size(data,2))*1.96;
    end
    %%%%%%%%%%%%%% R&flipL plot %%%%%%%%%%%
    for allV4 = 1
        
        tempdata = V4bin18;
        meandata = mean(tempdata,1);
        stddata = std(tempdata,1)/sqrt(size(tempdata,1))*1.96;
        fig = figure('color',[1 1 1]);
        set(fig,'units','normalized','position',[0.1 0.1 0.4 0.55]);
        hold on;
        plottype = [{'o'}];
        g = plot(ones(size(tempdata,2)+1,1)*(100/size(tempdata,2)),'--');hold on;
        set(g,'color',[0.5 0.5 0.5],'LineWidth',2);
        g = plot([10 10],[0 100],'--');hold on;
        set(g,'color',[0.5 0.5 0.5],'LineWidth',2);
        h(1) = errorbar([meandata,meandata(1)],[stddata,stddata(1)],plottype{1});hold on;
        set(h(1),'color',[0 0 0],'LineWidth',2.5,'Markersize',3,'MarkerFaceColor',[0 0 0]);
        h(2) = fill([20:1:360+20,fliplr(20:1:360+20)]/20,[yydown,yydown(1),fliplr([yyup,yyup(1)])],'-');hold on;
        set(h(2),'facecolor',Bcolor,'edgecolor','none');
        h(1) = plot([20:1:360+20]/20,[yyc,yyc(1)],'-');hold on;
        set(h(1),'color',Bcolor,'LineWidth',3.5);
        set(gca,'box','off');
        xlim([0.5,19.6]);
        ylim([4.7,6.35]);
        set(gca,'XTick',[1:4.5:50],'Xticklabel',{'0','45','90','135','180'},'fontsize',27);
        set(gca,'YTick',[0:0.5:10],'fontsize',27);
        set(gca,'Yticklabel',num2str(get(gca,'YTick')','%.1f'))
        xlabel('Orientation(¡ã)','fontsize',30);
        set(gca,'linewidth',1.5);

    end
    %%%%%%%%%%%%%% R&flipL %%%%%%%%%%%
    tempflip = fliplr(V4LshuffleOrdCurve');
    V4bin18 = [[V4LshuffleOrdCurve(18,:)',tempflip(:,1:end-1)];V4RshuffleOrdCurve'];
    %%%%%%%%%%%%%% up down rad cal %%%%%%%%%%%
    data = V4shuffleUyy;
    yyc = mean(data,2)';
    yyup=[];yydown=[];
    for i = 1:size(yyc,2)
        yyup(1,i) = yyc(i) + std(data(i,:))/sqrt(size(data,2))*1.96;
        yydown(1,i) = yyc(i) - std(data(i,:))/sqrt(size(data,2))*1.96;
    end
    %%%%%%%%%%%%%% R&flipL plot %%%%%%%%%%%
    for allV4 = 1
        
        tempdata = V4bin18;
        meandata = mean(tempdata,1);
        stddata = std(tempdata,1)/sqrt(size(tempdata,1))*1.96;
        h(1) = errorbar([meandata,meandata(1)],[stddata,stddata(1)],plottype{1});hold on;
        set(h(1),'color',[0.5 0.5 0.5],'LineWidth',2.5,'Markersize',3,'MarkerFaceColor','none');
        h(2) = fill([20:1:360+20,fliplr(20:1:360+20)]/20,[yydown,yydown(1),fliplr([yyup,yyup(1)])],'-');hold on;
        set(h(2),'facecolor',Bcolor,'edgecolor','none');
        h(1) = plot([20:1:360+20]/20,[yyc,yyc(1)],'-');hold on;
        set(h(1),'color',Bcolor,'LineWidth',3.5);
        set(gca,'box','off');
        xlim([0.5,19.6]);
        ylim([3.5,7.5]);
        set(gca,'XTick',[1:4.5:50],'Xticklabel',{'0','45','90','135','180'},'fontsize',27);
        set(gca,'YTick',[0:1:10],'fontsize',27);
        set(gca,'Yticklabel',num2str(get(gca,'YTick')','%.1f'))
        xlabel('Orientation(¡ã)','fontsize',30);
        set(gca,'linewidth',1.5);
        saveas(fig,[pwd,'\Figure_Results\Fig3E_V4_R&L_38cases_data_shuffle.tiff']);
        saveas(fig,[pwd,'\Figure_Results\Fig3E_V4_R&L_38cases_data_shuffle.pdf']);
        close all;

    end   

end

%% V1-V4 Ar Ac scatter  FigG-H
for V1V2V4AcArscatter = 1
    
    fig = figure('color',[1 1 1]);hold on;
    set(fig,'units','normalized','position',[0.1 0.1 0.45 0.48]);   %%%% figure size
    set(gca,'box','off');
    scatter(V1para(:,1),V1para(:,2),ones(1,size(V1para,1))*35,[0.2 0.2 0.2],'filled','markerfacecolor',[0.2 0.2 0.2]);
    scatter(V1shufflepara(:,1),V1shufflepara(:,2),ones(1,size(V1shufflepara,1))*35,[0.6 0.6 0.6],'filled','markerfacecolor',[0.6 0.6 0.6]);
    xlim([0 7.5]);
    ylim([0 4.5]);
    errorbar(mean(V1para(:,1)),mean(V1para(:,2)),std(V1para(:,1))/sqrt(size(V1para(:,1),1))*1.96,'linewidth',1);
    errorbar(mean(V1para(:,1)),mean(V1para(:,2)),std(V1para(:,2))/sqrt(size(V1para(:,2),1))*1.96,'horizontal','linewidth',1);
    errorbar(mean(V1shufflepara(:,1)),mean(V1shufflepara(:,2)),std(V1shufflepara(:,1))/sqrt(size(V1shufflepara(:,1),1))*1.96,'linewidth',1);
    errorbar(mean(V1shufflepara(:,1)),mean(V1shufflepara(:,2)),std(V1shufflepara(:,2))/sqrt(size(V1shufflepara(:,2),1))*1.96,'horizontal','linewidth',1);
    set(gca,'XTick',[0:1:360],'fontsize',15);
    set(gca,'YTick',[0:1:360],'fontsize',15);
    set(gca,'Yticklabel',num2str(get(gca,'YTick')','%.1f'));    %%% label 0.00
    set(gca,'Xticklabel',num2str(get(gca,'XTick')','%.1f'));    %%% label 0.00
    xlabel('Ac','fontsize',18);
    ylabel('Ar','fontsize',18);
    saveas(fig,[pwd,'\Figure_Results\Fig3G_V1_R&L_shuffle_46cases_AcAr.tiff']);
    saveas(fig,[pwd,'\Figure_Results\Fig3G_V1_R&L_shuffle_46cases_AcAr.pdf']);
    close all;

    fig = figure('color',[1 1 1]);hold on;
    set(fig,'units','normalized','position',[0.1 0.1 0.45 0.48]);   %%%% figure size
    set(gca,'box','off');
    scatter(V4wholepara(:,1),V4wholepara(:,2),ones(1,size(V4wholepara,1))*35,[0.2 0.2 0.2],'filled','markerfacecolor',[0.2 0.2 0.2]);
    scatter(V4shufflepara(:,1),V4shufflepara(:,2),ones(1,size(V4shufflepara,1))*35,[0.6 0.6 0.6],'filled','markerfacecolor',[0.6 0.6 0.6]);
    errorbar(mean(V4wholepara(:,1)),mean(V4wholepara(:,2)),std(V4wholepara(:,1))/sqrt(size(V4wholepara(:,1),1))*1.96,'horizontal','linewidth',1);
    errorbar(mean(V4wholepara(:,1)),mean(V4wholepara(:,2)),std(V4wholepara(:,2))/sqrt(size(V4wholepara(:,2),1))*1.96,'linewidth',1);
    errorbar(mean(V4shufflepara(:,1)),mean(V4shufflepara(:,2)),std(V4shufflepara(:,1))/sqrt(size(V4shufflepara(:,1),1))*1.96,'linewidth',1);
    errorbar(mean(V4shufflepara(:,1)),mean(V4shufflepara(:,2)),std(V4shufflepara(:,2))/sqrt(size(V4shufflepara(:,2),1))*1.96,'horizontal','linewidth',1);
    xlim([0 7.5]);
    ylim([0 4.5]);
    set(gca,'XTick',[0:1:360],'fontsize',15);
    set(gca,'YTick',[0:1:360],'fontsize',15);
    set(gca,'Yticklabel',num2str(get(gca,'YTick')','%.1f'));    %%% label 0.00
    set(gca,'Xticklabel',num2str(get(gca,'XTick')','%.1f'));    %%% label 0.00
    xlabel('Ac','fontsize',18);
    ylabel('Ar','fontsize',18);
    saveas(fig,[pwd,'\Figure_Results\Fig3H_V4_R&L_shuffle_38cases_AcAr.tiff']);
    saveas(fig,[pwd,'\Figure_Results\Fig3H_V4_R&L_shuffle_38cases_AcAr.pdf']);
    close all;
    
end
for AcrANOVA = 1
    data1 = V1para(:,1);
    data2 = V1para(:,2);
    data3 = V4wholepara(:,1);
    data4 = V4wholepara(:,2);
    data5 = V1shufflepara(:,1);
    data6 = V1shufflepara(:,2);
    data7 = V4shufflepara(:,1);
    data8 = V4shufflepara(:,2);
    Udata = [data1;data2;data3;data4;data5;data6;data7;data8];
    Hemiindex = [repmat({'1'},size(data1,1),1);repmat({'2'},size(data2,1),1);repmat({'3'},size(data3,1),1);repmat({'4'},size(data4,1),1);...
        repmat({'5'},size(data5,1),1);repmat({'6'},size(data6,1),1);repmat({'7'},size(data7,1),1);repmat({'8'},size(data8,1),1)];
    [p,tbl,stats,terms] = anovan(Udata,{Hemiindex});close all;fclose all;
    [tableInter,tableM,~,gnames] = multcompare(stats);close all;
end     %%%%%% ANOVA significants

%% V1-V4 FigI
for Anipct = 1
    
    data1 = V1Uyy;data2 = V1UyyCard;data3 = V1UyyRad;
    V1per = (sum(data2)+sum(data3))./sum(data1);
    data1 = V4wholeUyy;data2 = V4wholeUyyCard;data3 = V4wholeUyyRad;
    V4per = (sum(data2)+sum(data3))./sum(data1);
    data1 = [V1shuffleUyy,V4shuffleUyy];data2 = [V1shuffleUyyCard,V4shuffleUyyCard];data3 = [V1shuffleUyyRad,V4shuffleUyyRad];
    shuffleper = (sum(data2)+sum(data3))./sum(data1);
    fig = figure('color',[1 1 1]);hold on;
    set(fig,'units','normalized','position',[0.1 0.1 0.2 0.48]);   %%%% figure size
    set(gca,'box','off');
    bar([1 2 3],[100 100 100],'facecolor',[0.5 0.5 0.5],'edgecolor','none');
    bar([1 2 3],[mean(V1per) mean(V4per) mean(shuffleper)]*100,'facecolor',[220 20 220]/255,'edgecolor','none');
    errorbar([1 2 3],[mean(V1per) mean(V4per) mean(shuffleper)]*100,...
        [std(V1per)/sqrt(size(V1per,2))*1.96,std(V4per)/sqrt(size(V4per,2))*1.96,std(shuffleper)/sqrt(size(shuffleper,2))*1.96]*100,'.','color',[0 0 0],'linewidth',2);
    saveas(fig,[pwd,'\Figure_Results\Fig3I_ani_pct.tiff']);
    saveas(fig,[pwd,'\Figure_Results\Fig3I_ani_pct.pdf']);
    fclose all; close all;
    
end
for AcrANOVA = 1
    data1 = V1per';
    data2 = V4per';
    data3 = shuffleper';
    Udata = [data1;data2;data3];
    Hemiindex = [repmat({'1'},size(data1,1),1);repmat({'2'},size(data2,1),1);...
        repmat({'3'},size(data3,1),1)];
    [p,tbl,stats,terms] = anovan(Udata,{Hemiindex});close all;fclose all;
    [tableInter,tableM,~,gnames] = multcompare(stats);close all;
end     %%%%%% ANOVA

%% V1-V4 FigJ
for Anipct = 1
    
    data1 = V1Uyy;data2 = V1UyyCard;data3 = V1UyyRad;
    V1per = sum(data2)./(sum(data2)+sum(data3));
    data1 = V4wholeUyy;data2 = V4wholeUyyCard;data3 = V4wholeUyyRad;
    V4per = sum(data2)./(sum(data2)+sum(data3));
    fig = figure('color',[1 1 1]);hold on;
    set(fig,'units','normalized','position',[0.1 0.1 0.2 0.48]);   %%%% figure size
    set(gca,'box','off');
    bar([1 2],[100 100],'facecolor',[20 20 220]/255,'edgecolor','none');
    bar([1 2],[mean(V1per) mean(V4per)]*100,'facecolor',[220 20 20]/255,'edgecolor','none');
    errorbar([1 2],[mean(V1per) mean(V4per)]*100,...
        [std(V1per)/sqrt(size(V1per,2))*1.96,std(V4per)/sqrt(size(V4per,2))*1.96]*100,'.','color',[0 0 0],'linewidth',2);
    saveas(fig,[pwd,'\Figure_Results\Fig3J_ani_pct.tiff']);
    saveas(fig,[pwd,'\Figure_Results\Fig3J_ani_pct.pdf']);
    fclose all; close all;
    
end
for AcrANOVA = 1
    data1 = V1per';
    data2 = V4per';
    Udata = [data1;data2];
    Hemiindex = [repmat({'1'},size(data1,1),1);repmat({'2'},size(data2,1),1)];
    [p,tbl,stats,terms] = anovan(Udata,{Hemiindex});close all;fclose all;
    [tableInter,tableM,~,gnames] = multcompare(stats);close all;
end     %%%%%% ANOVA


